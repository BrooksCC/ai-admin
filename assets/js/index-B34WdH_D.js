import{j as e}from"./index-Cvcm6e8Y.js";import{u as _,r as u}from"./react-DR1zDSRy.js";import{W as j}from"./worldinfo-service-yWLoyq7P.js";import{F as o,s as p,C as F,R as T,a as f,S as I,B as c,w as U,a6 as z,I as b,r as S,t as B,a7 as M,d as E,a8 as H,a9 as q,k as G,c as J,f as C,x as Y,u as K,y as Q,M as A,U as X,q as Z,aa as ee,i as re,N as ne}from"./antd-CDJKHjm9.js";import"./echarts-C5AzJBXJ.js";const{Search:oe}=b,{Option:k}=E,{RangePicker:ae}=H,{Panel:le}=M,R={GLOBAL:{label:"全局世界书",color:"blue"},CHARACTER:{label:"角色世界书",color:"green"},CHAT:{label:"对话世界书",color:"orange"},PERSONA:{label:"个人世界书",color:"purple"},USER:{label:"用户自定义",color:"default"}},ie=({onAdd:h,onImport:x,refreshTrigger:g})=>{const a=_(),[d]=o.useForm(),[N,t]=u.useState(!1),[m,v]=u.useState([]),[w,l]=u.useState(0),[i,s]=u.useState({page:1,limit:10}),D=u.useCallback(async()=>{t(!0);try{const r=await j.searchWorldInfo(i);v(r.items||[]),l(r.total||0)}catch(r){console.error("获取世界信息列表失败:",r),p.error("获取世界信息列表失败")}finally{t(!1)}},[i]);u.useEffect(()=>{D()},[D,g]);const W=async r=>{try{await j.deleteWorldInfo(r),p.success("删除成功"),D()}catch(n){console.error("删除世界信息失败:",n),p.error("删除世界信息失败")}},y=r=>{s(n=>({...n,search:r,page:1}))},O=r=>{const n={page:1,limit:i.limit,...r};r.dateRange&&r.dateRange.length===2&&(n.createdFrom=r.dateRange[0].toISOString(),n.createdTo=r.dateRange[1].toISOString()),delete n.dateRange,s(n)},L=()=>{d.resetFields(),s({page:1,limit:i.limit})},$=r=>{s(n=>({...n,page:r.current,limit:r.pageSize}))},P=[{title:"ID",dataIndex:"id",key:"id",width:280,ellipsis:!0,render:(r,n)=>e.jsxDEV("a",{onClick:()=>a(`/worldinfo/${n.id}`),children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:148,columnNumber:5},void 0)},{title:"名称",dataIndex:"name",key:"name",width:250,ellipsis:!0,render:(r,n)=>e.jsxDEV("a",{onClick:()=>a(`/worldinfo/${n.id}`),children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:158,columnNumber:5},void 0)},{title:"类型",dataIndex:"type",key:"type",width:120,render:r=>{const n=R[r]||R.USER;return e.jsxDEV(C,{color:n.color,children:n.label},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:169,columnNumber:9},void 0)}},{title:"状态",dataIndex:"isActive",key:"isActive",width:80,render:r=>e.jsxDEV(C,{color:r?"green":"red",children:r?"激活":"禁用"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:181,columnNumber:5},void 0)},{title:"描述",dataIndex:"description",key:"description",ellipsis:!0},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:200,render:r=>new Date(r).toLocaleString()},{title:"更新时间",dataIndex:"updatedAt",key:"updatedAt",width:200,render:r=>new Date(r).toLocaleString()},{title:"操作",key:"action",width:200,fixed:"right",render:(r,n)=>e.jsxDEV(I,{size:"small",children:[e.jsxDEV(S,{title:"编辑",children:e.jsxDEV(c,{type:"text",icon:e.jsxDEV(Y,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:216,columnNumber:17},void 0),onClick:()=>a(`/worldinfo/${n.id}`)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:214,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:213,columnNumber:11},void 0),e.jsxDEV(K,{title:"确定删除此世界信息吗？",onConfirm:()=>W(n.id),okText:"确定",cancelText:"取消",children:e.jsxDEV(S,{title:"删除",children:e.jsxDEV(c,{type:"text",icon:e.jsxDEV(Q,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:227,columnNumber:41},void 0),danger:!0},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:227,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:226,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:220,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:212,columnNumber:5},void 0)}];return e.jsxDEV(F,{children:[e.jsxDEV(T,{justify:"space-between",align:"middle",style:{marginBottom:16},children:[e.jsxDEV(f,{children:e.jsxDEV(I,{children:[e.jsxDEV(c,{type:"primary",icon:e.jsxDEV(U,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:240,columnNumber:42},void 0),onClick:h,children:"新建世界信息"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:240,columnNumber:13},void 0),e.jsxDEV(c,{icon:e.jsxDEV(z,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:243,columnNumber:27},void 0),onClick:x,children:"导入世界书"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:243,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:239,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:238,columnNumber:9},void 0),e.jsxDEV(f,{children:e.jsxDEV(I,{children:[e.jsxDEV(oe,{placeholder:"输入关键词搜索",onSearch:y,style:{width:240},allowClear:!0},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:250,columnNumber:13},void 0),e.jsxDEV(S,{title:"刷新",children:e.jsxDEV(c,{icon:e.jsxDEV(B,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:257,columnNumber:29},void 0),onClick:D},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:257,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:256,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:249,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:248,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:237,columnNumber:7},void 0),e.jsxDEV(M,{style:{marginBottom:16},children:e.jsxDEV(le,{header:"高级搜索",extra:e.jsxDEV(G,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:265,columnNumber:45},void 0),children:e.jsxDEV(o,{form:d,layout:"vertical",onFinish:O,children:[e.jsxDEV(T,{gutter:16,children:[e.jsxDEV(f,{span:6,children:e.jsxDEV(o.Item,{label:"名称",name:"name",children:e.jsxDEV(b,{placeholder:"按名称搜索"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:274,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:273,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:272,columnNumber:15},void 0),e.jsxDEV(f,{span:6,children:e.jsxDEV(o.Item,{label:"描述",name:"description",children:e.jsxDEV(b,{placeholder:"按描述搜索"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:279,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:278,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:277,columnNumber:15},void 0),e.jsxDEV(f,{span:6,children:e.jsxDEV(o.Item,{label:"类型",name:"type",children:e.jsxDEV(E,{placeholder:"选择类型",allowClear:!0,children:[e.jsxDEV(k,{value:"GLOBAL",children:"全局世界书"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:285,columnNumber:21},void 0),e.jsxDEV(k,{value:"CHARACTER",children:"角色世界书"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:286,columnNumber:21},void 0),e.jsxDEV(k,{value:"CHAT",children:"对话世界书"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:287,columnNumber:21},void 0),e.jsxDEV(k,{value:"PERSONA",children:"个人世界书"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:288,columnNumber:21},void 0),e.jsxDEV(k,{value:"USER",children:"用户自定义"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:289,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:284,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:283,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:282,columnNumber:15},void 0),e.jsxDEV(f,{span:6,children:e.jsxDEV(o.Item,{label:"状态",name:"isActive",children:e.jsxDEV(E,{placeholder:"选择状态",allowClear:!0,children:[e.jsxDEV(k,{value:!0,children:"激活"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:296,columnNumber:21},void 0),e.jsxDEV(k,{value:!1,children:"禁用"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:297,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:295,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:294,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:293,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:271,columnNumber:13},void 0),e.jsxDEV(T,{gutter:16,children:[e.jsxDEV(f,{span:6,children:e.jsxDEV(o.Item,{label:"用户ID",name:"userId",children:e.jsxDEV(b,{placeholder:"按用户ID搜索"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:305,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:304,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:303,columnNumber:15},void 0),e.jsxDEV(f,{span:6,children:e.jsxDEV(o.Item,{label:"故事ID",name:"storyId",children:e.jsxDEV(b,{placeholder:"按故事ID搜索"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:310,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:309,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:308,columnNumber:15},void 0),e.jsxDEV(f,{span:6,children:e.jsxDEV(o.Item,{label:"角色ID",name:"characterId",children:e.jsxDEV(b,{placeholder:"按角色ID搜索"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:315,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:314,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:313,columnNumber:15},void 0),e.jsxDEV(f,{span:6,children:e.jsxDEV(o.Item,{label:"创建时间",name:"dateRange",children:e.jsxDEV(ae,{style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:320,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:319,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:318,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:302,columnNumber:13},void 0),e.jsxDEV(T,{children:e.jsxDEV(f,{children:e.jsxDEV(I,{children:[e.jsxDEV(c,{type:"primary",htmlType:"submit",icon:e.jsxDEV(q,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:327,columnNumber:66},void 0),children:"搜索"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:327,columnNumber:19},void 0),e.jsxDEV(c,{onClick:L,children:"重置"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:330,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:326,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:325,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:324,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:266,columnNumber:11},void 0)},"1",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:265,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:264,columnNumber:7},void 0),e.jsxDEV(J,{rowKey:"id",loading:N,columns:P,dataSource:m,pagination:{current:i.page,pageSize:i.limit,total:w,showSizeChanger:!0,showQuickJumper:!0,showTotal:(r,n)=>`第 ${n[0]}-${n[1]} 条，共 ${r} 条`},onChange:$,scroll:{x:"max-content"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:340,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:236,columnNumber:5},void 0)},{TextArea:de}=b,{Option:me}=E,se=[{value:"GLOBAL",label:"全局世界书",description:"适用于所有对话的通用信息"},{value:"CHARACTER",label:"角色世界书",description:"特定角色相关的背景信息"},{value:"CHAT",label:"对话世界书",description:"特定对话场景的信息"},{value:"PERSONA",label:"个人世界书",description:"个人角色设定信息"},{value:"USER",label:"用户自定义",description:"用户自定义的世界信息"}],ue=({visible:h,onCancel:x,onSuccess:g,editingWorldInfo:a})=>{const[d]=o.useForm(),[N,t]=u.useState(!1),m=!!a;u.useEffect(()=>{h&&(a?d.setFieldsValue({name:a.name,description:a.description,type:a.type}):(d.resetFields(),d.setFieldsValue({type:"USER"})))},[h,a,d]);const v=async()=>{try{const l=await d.validateFields();t(!0);const i={name:l.name,description:l.description,type:l.type};m?(await j.updateWorldInfo(a.id,i),p.success("更新世界信息成功")):(await j.createWorldInfo(i),p.success("创建世界信息成功")),g(),w()}catch(l){console.error("保存世界信息失败:",l),p.error("保存世界信息失败")}finally{t(!1)}},w=()=>{d.resetFields(),x()};return e.jsxDEV(A,{title:m?"编辑世界信息":"新建世界信息",open:h,onCancel:w,width:600,footer:[e.jsxDEV(c,{onClick:w,children:"取消"},"cancel",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:102,columnNumber:7},void 0),e.jsxDEV(c,{type:"primary",loading:N,onClick:v,children:m?"更新":"创建"},"submit",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:105,columnNumber:7},void 0)],children:e.jsxDEV(o,{form:d,layout:"vertical",children:[e.jsxDEV(o.Item,{name:"name",label:"名称",rules:[{required:!0,message:"请输入名称"},{max:100,message:"名称不能超过100个字符"}],children:e.jsxDEV(b,{placeholder:"请输入世界信息名称"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:124,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:116,columnNumber:9},void 0),e.jsxDEV(o.Item,{name:"type",label:"类型",rules:[{required:!0,message:"请选择世界书类型"}],children:e.jsxDEV(E,{placeholder:"请选择世界书类型",children:se.map(l=>e.jsxDEV(me,{value:l.value,children:e.jsxDEV("div",{children:[e.jsxDEV("div",{children:l.label},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:136,columnNumber:19},void 0),e.jsxDEV("div",{style:{fontSize:"12px",color:"#666",marginTop:"2px"},children:l.description},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:137,columnNumber:19},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:135,columnNumber:17},void 0)},l.value,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:134,columnNumber:13},void 0))},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:132,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:127,columnNumber:9},void 0),e.jsxDEV(o.Item,{name:"description",label:"描述",rules:[{max:500,message:"描述不能超过500个字符"}],children:e.jsxDEV(de,{rows:4,placeholder:"请输入世界信息描述（可选）"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:151,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:146,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:115,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:96,columnNumber:5},void 0)},{TextArea:te}=b,{Option:V}=E,ce=({visible:h,onCancel:x,onSuccess:g})=>{const[a]=o.useForm(),[d,N]=u.useState(!1),[t,m]=u.useState(null),v=i=>{const s=new FileReader;return s.onload=D=>{var W;try{const y=JSON.parse((W=D.target)==null?void 0:W.result);m(y),p.success("文件解析成功")}catch{p.error("文件格式不正确，请确保是有效的JSON文件"),m(null)}},s.readAsText(i),!1},w=async i=>{if(!t){p.error("请先上传并解析文件");return}N(!0);try{await j.importWorldInfo({name:i.name,description:i.description,type:i.type,data:t}),p.success("世界书导入成功"),a.resetFields(),m(null),g()}catch(s){console.error("Import failed:",s),p.error("导入失败，请检查文件格式和内容")}finally{N(!1)}},l=()=>{a.resetFields(),m(null),x()};return e.jsxDEV(A,{title:"导入世界书",open:h,onCancel:l,footer:null,width:600,destroyOnClose:!0,children:e.jsxDEV(o,{form:a,layout:"vertical",onFinish:w,initialValues:{type:"silly_tavern"},children:[e.jsxDEV(o.Item,{name:"name",label:"世界书名称",rules:[{required:!0,message:"请输入世界书名称"}],children:e.jsxDEV(b,{placeholder:"请输入世界书名称"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:95,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:90,columnNumber:9},void 0),e.jsxDEV(o.Item,{name:"description",label:"描述",children:e.jsxDEV(te,{placeholder:"请输入世界书描述（可选）",rows:3},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:102,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:98,columnNumber:9},void 0),e.jsxDEV(o.Item,{name:"type",label:"导入格式类型",rules:[{required:!0,message:"请选择导入格式类型"}],children:e.jsxDEV(E,{placeholder:"请选择导入格式类型",children:[e.jsxDEV(V,{value:"silly_tavern",children:"SillyTavern 世界书"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:114,columnNumber:13},void 0),e.jsxDEV(V,{value:"character_card",children:"角色卡片"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:115,columnNumber:13},void 0),e.jsxDEV(V,{value:"novel_ai",children:"NovelAI Lorebook"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:116,columnNumber:13},void 0),e.jsxDEV(V,{value:"agnai",children:"AGNAI Memory"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:117,columnNumber:13},void 0),e.jsxDEV(V,{value:"risu",children:"RisuAI Lorebook"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:118,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:113,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:108,columnNumber:9},void 0),e.jsxDEV(o.Item,{label:"上传文件",extra:e.jsxDEV(I,{children:[e.jsxDEV(ee,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:126,columnNumber:15},void 0),e.jsxDEV("span",{style:{color:"#666",fontSize:"12px"},children:"支持JSON格式文件，导入后将创建为全局世界书"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:127,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:125,columnNumber:11},void 0),children:[e.jsxDEV(X,{beforeUpload:v,accept:".json",maxCount:1,showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1},onRemove:()=>m(null),children:e.jsxDEV(c,{icon:e.jsxDEV(Z,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:143,columnNumber:27},void 0),children:"选择文件"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:143,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:133,columnNumber:11},void 0),t&&e.jsxDEV("div",{style:{marginTop:8,color:"#52c41a",fontSize:"12px"},children:"✓ 文件已解析，可以进行导入"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:148,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:122,columnNumber:9},void 0),e.jsxDEV(o.Item,{style:{marginBottom:0,marginTop:24},children:e.jsxDEV(I,{style:{width:"100%",justifyContent:"flex-end"},children:[e.jsxDEV(c,{onClick:l,children:"取消"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:156,columnNumber:13},void 0),e.jsxDEV(c,{type:"primary",htmlType:"submit",loading:d,disabled:!t,children:"导入"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:159,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:155,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:154,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:82,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoImportModal.tsx",lineNumber:74,columnNumber:5},void 0)},{Title:fe,Paragraph:pe}=re,Ie=()=>{const[h,x]=u.useState(0),[g,a]=u.useState(!1),[d,N]=u.useState(!1),t=()=>{a(!0)},m=()=>{a(!1)},v=()=>{x(s=>s+1),a(!1)},w=()=>{N(!0)},l=()=>{N(!1)},i=()=>{x(s=>s+1),N(!1)};return e.jsxDEV("div",{style:{padding:"24px"},children:[e.jsxDEV(I,{direction:"vertical",style:{width:"100%"},size:"large",children:[e.jsxDEV(F,{children:e.jsxDEV(I,{direction:"vertical",children:[e.jsxDEV(fe,{level:2,children:"世界书管理"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:45,columnNumber:13},void 0),e.jsxDEV(pe,{children:"世界书（World Info）用于管理故事或角色背景中的关键信息、设定和知识。 您可以创建、编辑和删除世界信息条目，这些信息可以在AI互动中被动态引用，以增强一致性和沉浸感。"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:46,columnNumber:13},void 0),e.jsxDEV(ne,{message:"搜索功能说明",description:"支持基础关键词搜索和高级搜索。高级搜索可以按名称、描述、类型、状态、关联ID和创建时间等多个维度进行精确筛选。",type:"info",showIcon:!0,closable:!0},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:50,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:44,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:43,columnNumber:9},void 0),e.jsxDEV(ie,{onAdd:t,onImport:w,refreshTrigger:h},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:60,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:42,columnNumber:7},void 0),e.jsxDEV(ue,{visible:g,onCancel:m,onSuccess:v,editingWorldInfo:null},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:66,columnNumber:8},void 0),e.jsxDEV(ce,{visible:d,onCancel:l,onSuccess:i},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:73,columnNumber:8},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:41,columnNumber:5},void 0)};export{Ie as default};
