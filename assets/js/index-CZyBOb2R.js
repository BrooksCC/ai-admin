import{u as E,j as t}from"./index-D04p1sBC.js";import{r as m,L as A}from"./react-DNsX-D9n.js";import{s as L}from"./admin-C111DiCg.js";import{S as y,a as p,b as R,R as T}from"./SearchRow-CBdl1kHL.js";import{S as k}from"./SearchContainer-Bw_VGvQC.js";import{u as C,a as D,S as P}from"./useTable-DE2CmjGe.js";import{A as v,F as z,I as h,a as $,o as B,K as u}from"./antd-Bzi-nNZC.js";import"./echarts-C9Czxobr.js";import"./admin-service-CMqY6kOT.js";import"./Button-DatrTJmw.js";import"./useWindowSize-CaV-WCuS.js";import"./useMutation-dG7v4qaY.js";import"./usePageTransfer-DK3jVjFi.js";function X(){const{t:s}=E(),x=m.useRef(null),{message:n}=v.useApp();m.useEffect(()=>{const e=localStorage.getItem("user.token");console.log("当前token状态:",e?"已存在":"不存在",e?`${e.substring(0,15)}...`:"")},[]);const f=async e=>{var c,d;console.log("正在请求用户列表...",{page:e.page,pageSize:e.pageSize,filters:e.filters});try{const r=(c=e.filters)==null?void 0:c.username,F=(d=e.filters)==null?void 0:d.email,o=await L(e.page,e.pageSize,r,F);return console.log("用户列表获取成功:",o),{list:o.items||[],total:o.total||0}}catch(r){return console.error("获取用户列表失败:",r),r instanceof Error?n.error(`获取用户列表失败: ${r.message}`):n.error("获取用户列表失败: 未知错误"),{list:[],total:0}}},{listContainerProps:g,tableScrollY:i}=C(),{form:a,tableProps:S,isLoading:j,handleReset:I}=D({key:"user-list",pagination:!0,listApiFn:e=>f({...e,filters:a==null?void 0:a.getFieldsValue()}),scrollY:i,formInitialValues:{username:void 0,email:void 0},columns:[{title:s("用户ID"),dataIndex:"id",width:280,render:e=>t.jsx(A,{to:`/user/${e}`,children:e})},{title:s("用户名"),dataIndex:"username",width:150},{title:s("昵称"),dataIndex:"nickname",width:150},{title:s("邮箱"),dataIndex:"email",width:200},{title:s("等级"),dataIndex:"level",width:80},{title:s("积分"),dataIndex:"points",width:80},{title:s("性别"),dataIndex:"gender",width:80,render:e=>e?s(e):"-"},{title:s("注册时间"),dataIndex:"createdAt",width:180,render:e=>new Date(e).toLocaleString()},{title:s("最后活跃时间"),dataIndex:"lastActiveAt",width:180,render:e=>e?new Date(e).toLocaleString():"-"}]}),l=a,w=()=>{l.submit()},b=t.jsx(z,{ref:x,form:l,colon:!1,autoComplete:"off",onFinish:w,children:t.jsx(k,{actions:t.jsx(t.Fragment,{children:t.jsxs($,{children:[t.jsx(R,{loading:j,htmlType:"submit"}),t.jsx(T,{onClick:I})]})}),children:t.jsxs(y,{children:[t.jsx(p,{name:"username",label:s("用户名"),children:t.jsx(h,{placeholder:s("请输入用户名")})}),t.jsx(p,{name:"email",label:s("邮箱"),children:t.jsx(h,{placeholder:s("请输入邮箱")})})]})})});return t.jsx(t.Fragment,{children:t.jsx(P,{...g,searchForm:b,children:t.jsx(B,{...S,locale:{emptyText:t.jsx(u,{description:s("暂无用户数据"),image:u.PRESENTED_IMAGE_SIMPLE})},scroll:{x:1500,y:i}})})})}export{X as default};
