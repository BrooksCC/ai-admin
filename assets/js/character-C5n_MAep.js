import{D as or,S as g,b as sr}from"./index-PonfSQbM.js";var cr;let ir;function lr(e,r,t,a,l,L){var S,c,T,_,A,F,D,q=Symbol.metadata||Symbol.for("Symbol.metadata"),x=Object.defineProperty,O=Object.create,n=[O(null),O(null)],i=r.length;function I(o,w,y){return function(s,u){w&&(u=s,s=e);for(var m=0;m<o.length;m++)u=o[m].apply(s,y?[u]:[]);return y?u:s}}function p(o,w,y,s){if(typeof o!="function"&&(s||o!==void 0))throw new TypeError(w+" must "+(y||"be")+" a function"+(s?"":" or undefined"));return o}function R(o,w,y,s,u,m,j,v,C,b,Z){function M(d){if(!Z(d))throw new TypeError("Attempted to access private element on non-instance")}var G=[].concat(w[0]),P=w[3],Q=!j,B=u===1,H=u===3,N=u===4,z=u===2;function U(d,$,tr){return function(k,ar){return $&&(ar=k,k=o),tr&&tr(k),h[d].call(k,ar)}}if(!Q){var h={},V=[],E=H?"get":N||B?"set":"value";if(C?(b||B?h={get:nr(function(){return P(this)},s,"get"),set:function(d){w[4](this,d)}}:h[E]=P,b||nr(h[E],s,z?"":E)):b||(h=Object.getOwnPropertyDescriptor(o,s)),!b&&!C){if((c=n[+v][s])&&(c^u)!=7)throw Error("Decorating two elements with the same name ("+h[E].name+") is not supported yet");n[+v][s]=u<3?1:u}}for(var f=o,K=G.length-1;K>=0;K-=y?2:1){var rr=p(G[K],"A decorator","be",!0),er=y?G[K-1]:void 0,X={},W={kind:["field","accessor","method","getter","setter","class"][u],name:s,metadata:S,addInitializer:(function(d,$){if(d.v)throw new TypeError("attempted to call addInitializer after decoration was finished");p($,"An initializer","be",!0),m.push($)}).bind(null,X)};if(Q)c=rr.call(er,f,W),X.v=1,p(c,"class decorators","return")&&(f=c);else if(W.static=v,W.private=C,c=W.access={has:C?Z.bind():function(d){return s in d}},N||(c.get=C?z?function(d){return M(d),h.value}:U("get",0,M):function(d){return d[s]}),z||H||(c.set=C?U("set",0,M):function(d,$){d[s]=$}),f=rr.call(er,B?{get:h.get,set:h.set}:h[E],W),X.v=1,B){if(typeof f=="object"&&f)(c=p(f.get,"accessor.get"))&&(h.get=c),(c=p(f.set,"accessor.set"))&&(h.set=c),(c=p(f.init,"accessor.init"))&&V.unshift(c);else if(f!==void 0)throw new TypeError("accessor decorators must return an object with get, set, or init properties or undefined")}else p(f,(b?"field":"method")+" decorators","return")&&(b?V.unshift(f):h[E]=f)}return u<2&&j.push(I(V,v,1),I(m,v,0)),b||Q||(C?B?j.splice(-1,0,U("get",v),U("set",v)):j.push(z?h[E]:p.call.bind(h[E])):x(o,s,h)),f}function Y(o){return x(o,q,{configurable:!0,enumerable:!0,value:S})}return S=O(S??null),A=[],F=function(o){o&&A.push(I(o))},D=function(o,w){for(var y=0;y<t.length;y++){var s=t[y],u=s[1],m=7&u;if((8&u)==o&&!m==w){var j=s[2],v=!!s[3],C=16&u;R(o?e:e.prototype,s,C,v?"#"+j:hr(j),m,m<2?[]:o?_=_||[]:T=T||[],A,!!o,v,w,o&&v?function(b){return pr(b)===e}:l)}}},D(8,0),D(0,0),D(8,1),D(0,1),F(T),F(_),c=A,i||Y(e),{e:c,get c(){var o=[];return i&&[Y(e=R(e,[r],a,e.name,5,o)),I(o,1)]}}}function hr(e){var r=dr(e,"string");return typeof r=="symbol"?r:r+""}function dr(e,r){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var a=t.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function nr(e,r,t){typeof r=="symbol"&&(r=(r=r.description)?"["+r+"]":"");try{Object.defineProperty(e,"name",{configurable:!0,value:t?t+" "+r:r})}catch{}return e}function pr(e){if(Object(e)!==e)throw TypeError("right-hand side of 'in' should be an object, got "+(e!==null?typeof e:"null"));return e}let ur;class fr{async create(r){try{return(await g.characters.create({createCharacterRequestDto:r})).data}catch(t){throw console.error("Failed to create character:",t),t}}async favoriteCharacter(r){try{await g.characters.favoriteCharacter({id:r})}catch(t){throw console.error("Failed to favorite character:",t),t}}async findUserFavorites(r,t,a){try{return(await g.characters.findUserFavorites({userId:r,page:t,limit:a})).data}catch(l){throw console.error("Failed to find user favorites:",l),l}}async getAllCategoriesWithPopularTags(){try{return(await g.characters.getAllCategoriesWithPopularTags()).data}catch(r){throw console.error("Failed to get all categories with popular tags:",r),r}}async getCharacterDetail(r){try{return(await g.characters.getCharacterDetail({id:r})).data}catch(t){throw console.error("Failed to get character detail:",t),t}}async getRatings(r,t,a){try{return(await g.characters.getRatings({id:r,page:t,limit:a})).data}catch(l){throw console.error("Failed to get ratings:",l),l}}async importCharacter(r,t){try{return(await g.characters.importCharacter({format:r,preservedFileName:t})).data}catch(a){throw console.error("Failed to import character:",a),a}}async rateCharacter(r,t){try{return(await g.characters.rateCharacter({id:r,rateCharacterRequestDto:t})).data}catch(a){throw console.error("Failed to rate character:",a),a}}async remove(r){try{await g.characters.remove({id:r})}catch(t){throw console.error("Failed to remove character:",t),t}}async searchCharacters(r,t,a={}){try{return(await g.characters.searchCharacters({page:r,limit:t,...a})).data}catch(l){throw console.error("Failed to search characters:",l),l}}async unfavoriteCharacter(r){try{await g.characters.unfavoriteCharacter({id:r})}catch(t){throw console.error("Failed to unfavorite character:",t),t}}async update(r,t){try{return(await g.characters.update({id:r,updateCharacterRequestDto:t})).data}catch(a){throw console.error("Failed to update character:",a),a}}}cr=fr;[ur,ir]=lr(cr,[or,or.Singleton],[],1).c;ir();const J=new ur,gr="https://bvyw4dvnxe.ap-southeast-1.awsapprunner.com";async function vr(e){try{const r=await J.searchCharacters(e.page||1,e.limit||20,{search:e.search,visibility:e.visibility,status:e.status,creatorId:e.creatorId,categoryIds:e.categoryIds,tags:e.tags,sortBy:e.sortBy,sortOrder:e.sortOrder,categoryId:e.categoryId});return{characters:r.items||[],totalCount:r.total||0}}catch(r){throw console.error("Error in searchCharacters:",r),r}}function wr(e){return J.getCharacterDetail(e)}function mr(e,r){return J.update(e,r)}function Cr(){return J.getAllCategoriesWithPopularTags()}async function br(e,r){var t,a,l,L,S,c,T,_,A,F,D,q,x,O;try{const n={};r&&(n.Authorization=`Bearer ${r}`);const i=await sr.post(`${gr}/api/v1/characters/import`,e,{headers:n});if(i.status===201||i.status===200)return console.log("角色导入成功:",i.data),i.data;throw console.error(`角色导入失败 (status ${i.status}):`,i.data),new Error(`导入失败，状态码: ${i.status}, 详情: ${JSON.stringify(i.data)}`)}catch(n){console.error("角色导入 API 调用出错:",n);let i="导入角色时发生未知错误。",I=null;if(sr.isAxiosError(n)){if(console.error("Axios error details:",{message:n.message,responseStatus:(t=n.response)==null?void 0:t.status,responseData:(a=n.response)==null?void 0:a.data}),I=(l=n.response)==null?void 0:l.data,i=((S=(L=n.response)==null?void 0:L.data)==null?void 0:S.message)||n.message||"网络请求错误",(_=(T=(c=n.response)==null?void 0:c.data)==null?void 0:T.message)!=null&&_.includes("bucket does not exist"))console.error((F=(A=n.response)==null?void 0:A.data)==null?void 0:F.message);else if(((D=n.response)==null?void 0:D.status)===401)i="认证失败，请检查Token或重新登录。";else if(((q=n.response)==null?void 0:q.status)===400){const R=(O=(x=n.response)==null?void 0:x.data)==null?void 0:O.message;Array.isArray(R)?i=`请求参数错误: ${R.join(", ")}`:i=`请求参数错误: ${R||"请检查提交的数据"}`}}else i=n.message||"发生未知错误";const p=new Error(i);throw p.originalError=n,p.data=I,p.isOperational=!0,p}}export{wr as a,Cr as g,br as i,vr as s,mr as u};
