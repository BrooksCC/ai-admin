import{j as e}from"./index-BbKG2Rqf.js";import{e as S,u as A,r as s}from"./react-DR1zDSRy.js";import{A as c}from"./admin-service-QVTvGNHz.js";import{F as a,s as t,g as T,B as p,h as U,i as B,C as O,I as d,d as m,T as h,e as v}from"./antd-CDJKHjm9.js";import"./echarts-C5AzJBXJ.js";const{Title:L}=B;function H(){const l=S().id,n=A(),[u]=a.useForm(),[N,E]=s.useState(null),[D,w]=s.useState([]),[k,f]=s.useState(!0),[V,x]=s.useState(!1),[j,b]=s.useState(!1);s.useEffect(()=>{if(!l){t.error("模型ID无效"),n("/model");return}async function r(){try{f(!0);const i=(await c.getAllModels()).find(F=>F.id===l);if(!i){t.error("模型不存在"),n("/model");return}E(i);const C=await c.getAllProviders();w(C),u.setFieldsValue({name:i.name,description:i.description,providerId:i.providerId,modelIdentifier:i.modelIdentifier,contextLength:i.contextLength,supportedFeatures:i.supportedFeatures?JSON.stringify(i.supportedFeatures,null,2):"",recommendedUse:i.recommendedUse,isEnabled:i.isEnabled,priority:i.priority,status:i.status,minBillingUnit:i.minBillingUnit,isDefault:i.isDefault,useCase:i.useCase})}catch(o){console.error("获取模型详情失败:",o),t.error("获取模型详情失败，请稍后重试"),n("/model")}finally{f(!1)}}r()},[l,u,n]);const y=()=>{b(!0)},I=async()=>{if(!l){t.error("模型ID无效");return}try{await u.validateFields();const r=u.getFieldsValue();x(!0);let o=null;if(r.supportedFeatures&&r.supportedFeatures.trim())try{o=JSON.parse(r.supportedFeatures)}catch{t.error("支持的功能JSON格式错误");return}const i={name:r.name,description:r.description||void 0,providerId:r.providerId,modelIdentifier:r.modelIdentifier,contextLength:r.contextLength,supportedFeatures:o,recommendedUse:r.recommendedUse||void 0,isEnabled:r.isEnabled,priority:r.priority,status:r.status,minBillingUnit:r.minBillingUnit,isDefault:r.isDefault,useCase:r.useCase||void 0};await c.updateModel(l,i),t.success("模型更新成功"),b(!1),n("/model")}catch(r){console.error("更新模型失败:",r),t.error(`更新模型失败: ${r.message||"请稍后重试"}`)}finally{x(!1)}},g=()=>{if(j){t.warning("您有未保存的更改");return}n("/model")};return k?e.jsxDEV("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px"},children:e.jsxDEV(T,{size:"large"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:153,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:152,columnNumber:7},this):N?e.jsxDEV("div",{style:{padding:"24px"},children:[e.jsxDEV("div",{style:{marginBottom:"24px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxDEV("div",{style:{display:"flex",alignItems:"center"},children:[e.jsxDEV(p,{type:"text",icon:e.jsxDEV(U,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:169,columnNumber:19},this),onClick:g,style:{marginRight:"16px"},children:"返回列表"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:167,columnNumber:11},this),e.jsxDEV(L,{level:3,style:{margin:0},children:["编辑模型:"," ",N.name]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:175,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:166,columnNumber:9},this),e.jsxDEV("div",{children:[e.jsxDEV(p,{onClick:g,style:{marginRight:"8px"},children:"取消"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:182,columnNumber:11},this),e.jsxDEV(p,{type:"primary",loading:V,onClick:I,children:"保存"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:188,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:181,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:165,columnNumber:7},this),e.jsxDEV(O,{children:e.jsxDEV(a,{form:u,layout:"vertical",onValuesChange:y,autoComplete:"off",children:[e.jsxDEV(a.Item,{name:"name",label:"模型名称",rules:[{required:!0,message:"请输入模型名称"}],children:e.jsxDEV(d,{placeholder:"请输入模型名称"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:211,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:206,columnNumber:11},this),e.jsxDEV(a.Item,{name:"providerId",label:"供应商",rules:[{required:!0,message:"请选择供应商"}],children:e.jsxDEV(m,{placeholder:"请选择供应商",children:D.map(r=>e.jsxDEV(m.Option,{value:r.id,children:r.name},r.id,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:221,columnNumber:15},this))},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:219,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:214,columnNumber:11},this),e.jsxDEV(a.Item,{name:"modelIdentifier",label:"模型标识符",rules:[{required:!0,message:"请输入模型标识符"}],children:e.jsxDEV(d,{placeholder:"请输入模型标识符"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:233,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:228,columnNumber:11},this),e.jsxDEV(a.Item,{name:"description",label:"模型描述",children:e.jsxDEV(d.TextArea,{rows:3,placeholder:"请输入模型描述"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:240,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:236,columnNumber:11},this),e.jsxDEV("div",{style:{display:"flex",gap:"16px"},children:[e.jsxDEV(a.Item,{name:"contextLength",label:"上下文长度",style:{flex:1},children:e.jsxDEV(h,{min:1,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:249,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:244,columnNumber:13},this),e.jsxDEV(a.Item,{name:"priority",label:"优先级",style:{flex:1},children:e.jsxDEV(h,{style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:257,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:252,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:243,columnNumber:11},this),e.jsxDEV(a.Item,{name:"minBillingUnit",label:"最小计费单位",children:e.jsxDEV(h,{min:1,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:265,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:261,columnNumber:11},this),e.jsxDEV(a.Item,{name:"status",label:"模型状态",children:e.jsxDEV(m,{children:[e.jsxDEV(m.Option,{value:"ACTIVE",children:"活跃"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:273,columnNumber:15},this),e.jsxDEV(m.Option,{value:"INACTIVE",children:"非活跃"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:274,columnNumber:15},this),e.jsxDEV(m.Option,{value:"DEPRECATED",children:"已弃用"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:275,columnNumber:15},this),e.jsxDEV(m.Option,{value:"MAINTENANCE",children:"维护中"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:276,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:272,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:268,columnNumber:11},this),e.jsxDEV(a.Item,{name:"recommendedUse",label:"推荐用途",children:e.jsxDEV(d,{placeholder:"请输入推荐用途"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:284,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:280,columnNumber:11},this),e.jsxDEV(a.Item,{name:"useCase",label:"使用场景",children:e.jsxDEV(d,{placeholder:"请输入使用场景"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:291,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:287,columnNumber:11},this),e.jsxDEV(a.Item,{name:"supportedFeatures",label:"支持的功能",help:"请输入有效的JSON格式",children:e.jsxDEV(d.TextArea,{rows:4,placeholder:'{"chat": true, "completion": true}'},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:299,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:294,columnNumber:11},this),e.jsxDEV("div",{style:{display:"flex",gap:"16px"},children:[e.jsxDEV(a.Item,{name:"isEnabled",label:"是否启用",valuePropName:"checked",style:{flex:1},children:e.jsxDEV(v,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:309,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:303,columnNumber:13},this),e.jsxDEV(a.Item,{name:"isDefault",label:"是否默认",valuePropName:"checked",style:{flex:1},children:e.jsxDEV(v,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:318,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:312,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:302,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:200,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:199,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/model/[id]/edit.tsx",lineNumber:163,columnNumber:5},this):null}export{H as default};
