import{j as e}from"./index-DkoX4alL.js";import{u as T,r as l}from"./react-DR1zDSRy.js";import{W as h}from"./worldinfo-service-BLiY3IuS.js";import{s as f,C as D,R as y,a as I,S as b,B as w,r as S,I as k,w as v,J as C,c as F,G as A,H as R,F as x,M as L,h as M}from"./antd-C5ilffvX.js";import"./echarts-C5AzJBXJ.js";const{Search:z}=k,P=({onAdd:d,refreshTrigger:p})=>{const c=T(),[n,o]=l.useState(!1),[N,u]=l.useState([]),[s,g]=l.useState(0),[i,t]=l.useState({page:1,limit:10}),m=l.useCallback(async()=>{o(!0);try{const r=await h.getWorldInfoList(i.page,i.limit,i.keyword);u(r.items||[]),g(r.total||0)}catch(r){console.error("获取世界信息列表失败:",r),f.error("获取世界信息列表失败")}finally{o(!1)}},[i]);l.useEffect(()=>{m()},[m,p]);const E=async r=>{try{await h.deleteWorldInfo(r),f.success("删除成功"),m()}catch(a){console.error("删除世界信息失败:",a),f.error("删除世界信息失败")}},j=r=>{t(a=>({...a,keyword:r,page:1}))},V=r=>{t(a=>({...a,page:r.current,limit:r.pageSize}))},W=[{title:"ID",dataIndex:"id",key:"id",width:280,ellipsis:!0,render:(r,a)=>e.jsxDEV("a",{onClick:()=>c(`/worldinfo/${a.id}`),children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:101,columnNumber:5},void 0)},{title:"名称",dataIndex:"name",key:"name",width:250,ellipsis:!0,render:(r,a)=>e.jsxDEV("a",{onClick:()=>c(`/worldinfo/${a.id}`),children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:111,columnNumber:5},void 0)},{title:"描述",dataIndex:"description",key:"description",ellipsis:!0},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:200,render:r=>new Date(r).toLocaleString()},{title:"更新时间",dataIndex:"updatedAt",key:"updatedAt",width:200,render:r=>new Date(r).toLocaleString()},{title:"操作",key:"action",width:150,fixed:"right",render:(r,a)=>e.jsxDEV(b,{size:"small",children:e.jsxDEV(A,{title:"确定删除此世界信息吗？",onConfirm:()=>E(a.id),okText:"确定",cancelText:"取消",children:e.jsxDEV(v,{title:"删除",children:e.jsxDEV(w,{type:"text",icon:e.jsxDEV(R,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:148,columnNumber:41},void 0),danger:!0},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:148,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:147,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:141,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:140,columnNumber:5},void 0)}];return e.jsxDEV(D,{children:[e.jsxDEV(y,{justify:"space-between",align:"middle",style:{marginBottom:16},children:[e.jsxDEV(I,{children:e.jsxDEV(b,{children:e.jsxDEV(w,{type:"primary",icon:e.jsxDEV(S,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:161,columnNumber:42},void 0),onClick:d,children:"新建世界信息"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:161,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:160,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:159,columnNumber:9},void 0),e.jsxDEV(I,{children:e.jsxDEV(b,{children:[e.jsxDEV(z,{placeholder:"输入关键词搜索",onSearch:j,style:{width:240},allowClear:!0},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:168,columnNumber:13},void 0),e.jsxDEV(v,{title:"刷新",children:e.jsxDEV(w,{icon:e.jsxDEV(C,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:175,columnNumber:29},void 0),onClick:m},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:175,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:174,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:167,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:166,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:158,columnNumber:7},void 0),e.jsxDEV(F,{rowKey:"id",loading:n,columns:W,dataSource:N,pagination:{current:i.page,pageSize:i.limit,total:s},onChange:V,scroll:{x:"max-content"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:180,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoTable.tsx",lineNumber:157,columnNumber:5},void 0)},{TextArea:$}=k,B=({visible:d,onCancel:p,onSuccess:c,editingWorldInfo:n})=>{const[o]=x.useForm(),[N,u]=l.useState(!1),s=!!n;l.useEffect(()=>{d&&(n?o.setFieldsValue({name:n.name,description:n.description}):o.resetFields())},[d,n,o]);const g=async()=>{try{const t=await o.validateFields();u(!0);const m={name:t.name,description:t.description,type:"USER"};s?(await h.updateWorldInfo(n.id,m),f.success("更新世界信息成功")):(await h.createWorldInfo(m),f.success("创建世界信息成功")),c(),i()}catch(t){console.error("保存世界信息失败:",t),f.error("保存世界信息失败")}finally{u(!1)}},i=()=>{o.resetFields(),p()};return e.jsxDEV(L,{title:s?"编辑世界信息":"新建世界信息",open:d,onCancel:i,width:600,footer:[e.jsxDEV(w,{onClick:i,children:"取消"},"cancel",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:86,columnNumber:7},void 0),e.jsxDEV(w,{type:"primary",loading:N,onClick:g,children:s?"更新":"创建"},"submit",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:89,columnNumber:7},void 0)],children:e.jsxDEV(x,{form:o,layout:"vertical",children:[e.jsxDEV(x.Item,{name:"name",label:"名称",rules:[{required:!0,message:"请输入名称"},{max:100,message:"名称不能超过100个字符"}],children:e.jsxDEV(k,{placeholder:"请输入世界信息名称"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:108,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:100,columnNumber:9},void 0),e.jsxDEV(x.Item,{name:"description",label:"描述",rules:[{max:500,message:"描述不能超过500个字符"}],children:e.jsxDEV($,{rows:4,placeholder:"请输入世界信息描述（可选）"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:116,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:111,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:99,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoForm.tsx",lineNumber:80,columnNumber:5},void 0)},{Title:q,Paragraph:G}=M,O=()=>{const[d,p]=l.useState(0),[c,n]=l.useState(!1),o=()=>{n(!0)},N=()=>{n(!1)},u=()=>{p(s=>s+1),n(!1)};return e.jsxDEV("div",{style:{padding:"24px"},children:[e.jsxDEV(b,{direction:"vertical",style:{width:"100%"},size:"large",children:[e.jsxDEV(D,{children:e.jsxDEV(b,{direction:"vertical",children:[e.jsxDEV(q,{level:2,children:"世界书管理"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:30,columnNumber:13},void 0),e.jsxDEV(G,{children:"世界书（World Info）用于管理故事或角色背景中的关键信息、设定和知识。 您可以创建、编辑和删除世界信息条目，这些信息可以在AI互动中被动态引用，以增强一致性和沉浸感。"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:31,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:29,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:28,columnNumber:9},void 0),e.jsxDEV(P,{onAdd:o,refreshTrigger:d},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:38,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:27,columnNumber:7},void 0),e.jsxDEV(B,{visible:c,onCancel:N,onSuccess:u,editingWorldInfo:null},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:43,columnNumber:8},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/index.tsx",lineNumber:26,columnNumber:5},void 0)};export{O as default};
