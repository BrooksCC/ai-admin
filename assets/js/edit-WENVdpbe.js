import{j as e}from"./index-CLsFyRhf.js";import{e as T,u as C,r as d}from"./react-DR1zDSRy.js";import{A as x}from"./admin-service-Ce3remOt.js";import{F as i,s as n,g as K,B as h,h as q,i as A,C as F,I as t,d as k,T as s,e as y}from"./antd-Sq0EuMdw.js";import"./echarts-C5AzJBXJ.js";const{Title:M}=A;function z(){const u=T().id,l=C(),[o]=i.useForm(),[m,w]=d.useState(null),[D,j]=d.useState([]),[E,f]=d.useState(!0),[V,b]=d.useState(!1),[P,g]=d.useState(!1);d.useEffect(()=>{if(!u){n.error("参数ID无效"),l("/modelparameter");return}async function r(){var p;try{f(!0);const a=await x.getModelParameter(u);w(a);const N=await x.getAllModels();j(N.map(c=>({id:c.id,name:c.name||c.id}))),o.setFieldsValue({parameterSetName:a.parameterSetName,modelId:a.modelId,presetId:a.presetId,description:a.description,notes:a.notes,temperature:a.temperature,maxTokens:a.maxTokens,maxInputTokens:a.maxInputTokens,topP:a.topP,topK:a.topK,stopSequences:((p=a.stopSequences)==null?void 0:p.join(`
`))||"",frequencyPenalty:a.frequencyPenalty,presencePenalty:a.presencePenalty,isDefault:a.isDefault,extraParams:a.extraParams?JSON.stringify(a.extraParams,null,2):"",providerId:a.providerId,currencyCode:a.currencyCode,inputPricePerK:a.inputPricePerK,outputPricePerK:a.outputPricePerK,isPricingActive:a.isPricingActive})}catch(a){console.error("获取参数详情失败:",a),n.error("获取参数详情失败，请稍后重试"),l("/modelparameter")}finally{f(!1)}}r()},[u,o,l]);const I=()=>{g(!0)},S=async()=>{if(!u){n.error("参数ID无效");return}try{await o.validateFields();const r=o.getFieldsValue();b(!0);const p=r.stopSequences?r.stopSequences.split(`
`).filter(c=>c.trim()):[];let a=null;if(r.extraParams&&r.extraParams.trim())try{a=JSON.parse(r.extraParams)}catch{n.error("额外参数JSON格式错误");return}const N={description:r.description||null,temperature:r.temperature,maxTokens:r.maxTokens,maxInputTokens:r.maxInputTokens,topP:r.topP,topK:r.topK,stopSequences:p,frequencyPenalty:r.frequencyPenalty,presencePenalty:r.presencePenalty,isDefault:r.isDefault,notes:r.notes||null,extraParams:a,providerId:r.providerId||null,currencyCode:r.currencyCode||null,inputPricePerK:r.inputPricePerK||null,outputPricePerK:r.outputPricePerK||null,isPricingActive:r.isPricingActive};await x.updateModelParameter(u,N),n.success("参数更新成功"),g(!1),l("/modelparameter")}catch(r){console.error("更新参数失败:",r),n.error(`更新参数失败: ${r.message||"请稍后重试"}`)}finally{b(!1)}},v=()=>{if(P){n.warning("您有未保存的更改");return}l("/modelparameter")};return E?e.jsxDEV("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px"},children:e.jsxDEV(K,{size:"large"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:164,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:163,columnNumber:7},this):m?e.jsxDEV("div",{style:{padding:"24px"},children:[e.jsxDEV("div",{style:{marginBottom:"24px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxDEV("div",{style:{display:"flex",alignItems:"center"},children:[e.jsxDEV(h,{type:"text",icon:e.jsxDEV(q,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:180,columnNumber:19},this),onClick:v,style:{marginRight:"16px"},children:"返回列表"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:178,columnNumber:11},this),e.jsxDEV(M,{level:3,style:{margin:0},children:["编辑参数集:"," ",m.parameterSetName]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:186,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:177,columnNumber:9},this),e.jsxDEV("div",{children:[e.jsxDEV(h,{onClick:v,style:{marginRight:"8px"},children:"取消"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:193,columnNumber:11},this),e.jsxDEV(h,{type:"primary",loading:V,onClick:S,children:"保存"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:199,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:192,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:176,columnNumber:7},this),e.jsxDEV(F,{children:e.jsxDEV(i,{form:o,layout:"vertical",onValuesChange:I,autoComplete:"off",children:[e.jsxDEV(i.Item,{name:"parameterSetName",label:"虚拟模型名",rules:[{required:!0,message:"请输入虚拟模型名"}],children:e.jsxDEV(t,{placeholder:"请输入虚拟模型名",disabled:!0},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:222,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:217,columnNumber:11},this),e.jsxDEV(i.Item,{name:"modelId",label:"模型",rules:[{required:!0,message:"请选择模型"}],children:e.jsxDEV(k,{placeholder:"请选择模型",disabled:!0,children:D.map(r=>e.jsxDEV(k.Option,{value:r.id,children:r.name},r.id,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:232,columnNumber:15},this))},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:230,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:225,columnNumber:11},this),e.jsxDEV(i.Item,{name:"presetId",label:"预设ID",children:m!=null&&m.presetId?e.jsxDEV(h,{type:"link",onClick:()=>l(`/preset/${m.presetId}`),style:{padding:0,height:"auto",textAlign:"left"},children:m.presetId},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:245,columnNumber:13},this):e.jsxDEV("span",{style:{color:"#999"},children:"未绑定预设"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:254,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:239,columnNumber:11},this),e.jsxDEV(i.Item,{name:"description",label:"虚拟模型名描述",children:e.jsxDEV(t.TextArea,{rows:3,placeholder:"请输入虚拟模型名描述"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:262,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:258,columnNumber:11},this),e.jsxDEV(i.Item,{name:"notes",label:"备注",children:e.jsxDEV(t,{placeholder:"请输入备注"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:269,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:265,columnNumber:11},this),e.jsxDEV("div",{style:{display:"flex",gap:"16px"},children:[e.jsxDEV(i.Item,{name:"temperature",label:"温度参数",style:{flex:1},children:e.jsxDEV(s,{min:0,max:2,step:.1,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:278,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:273,columnNumber:13},this),e.jsxDEV(i.Item,{name:"maxTokens",label:"最大Token数",style:{flex:1},children:e.jsxDEV(s,{min:1,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:286,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:281,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:272,columnNumber:11},this),e.jsxDEV("div",{style:{display:"flex",gap:"16px"},children:[e.jsxDEV(i.Item,{name:"maxInputTokens",label:"最大输入Token数",style:{flex:1},children:e.jsxDEV(s,{min:1,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:296,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:291,columnNumber:13},this),e.jsxDEV(i.Item,{name:"topP",label:"顶部概率采样",style:{flex:1},children:e.jsxDEV(s,{min:0,max:1,step:.1,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:304,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:299,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:290,columnNumber:11},this),e.jsxDEV("div",{style:{display:"flex",gap:"16px"},children:[e.jsxDEV(i.Item,{name:"topK",label:"顶部K采样",style:{flex:1},children:e.jsxDEV(s,{min:0,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:314,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:309,columnNumber:13},this),e.jsxDEV(i.Item,{name:"frequencyPenalty",label:"频率惩罚",style:{flex:1},children:e.jsxDEV(s,{min:0,step:.1,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:322,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:317,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:308,columnNumber:11},this),e.jsxDEV(i.Item,{name:"presencePenalty",label:"存在惩罚",children:e.jsxDEV(s,{min:0,step:.1,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:330,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:326,columnNumber:11},this),e.jsxDEV(i.Item,{name:"stopSequences",label:"停止序列",help:"每行一个停止序列",children:e.jsxDEV(t.TextArea,{rows:3,placeholder:"请输入停止序列，每行一个"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:338,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:333,columnNumber:11},this),e.jsxDEV(i.Item,{name:"extraParams",label:"额外参数",help:"请输入有效的JSON格式",children:e.jsxDEV(t.TextArea,{rows:4,placeholder:'{"customParam": "value"}'},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:346,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:341,columnNumber:11},this),e.jsxDEV("div",{style:{display:"flex",gap:"16px"},children:[e.jsxDEV(i.Item,{name:"providerId",label:"供应商ID",style:{flex:1},children:e.jsxDEV(t,{placeholder:"请输入供应商ID"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:355,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:350,columnNumber:13},this),e.jsxDEV(i.Item,{name:"currencyCode",label:"货币代码",style:{flex:1},children:e.jsxDEV(t,{placeholder:"USD"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:363,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:358,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:349,columnNumber:11},this),e.jsxDEV("div",{style:{display:"flex",gap:"16px"},children:[e.jsxDEV(i.Item,{name:"inputPricePerK",label:"输入价格(/1K tokens)",style:{flex:1},children:e.jsxDEV(t,{placeholder:"0.001"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:373,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:368,columnNumber:13},this),e.jsxDEV(i.Item,{name:"outputPricePerK",label:"输出价格(/1K tokens)",style:{flex:1},children:e.jsxDEV(t,{placeholder:"0.002"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:381,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:376,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:367,columnNumber:11},this),e.jsxDEV("div",{style:{display:"flex",gap:"16px"},children:[e.jsxDEV(i.Item,{name:"isDefault",label:"是否默认",valuePropName:"checked",style:{flex:1},children:e.jsxDEV(y,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:392,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:386,columnNumber:13},this),e.jsxDEV(i.Item,{name:"isPricingActive",label:"价格是否激活",valuePropName:"checked",style:{flex:1},children:e.jsxDEV(y,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:401,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:395,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:385,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:211,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:210,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/modelparameter/[id]/edit.tsx",lineNumber:174,columnNumber:5},this):null}export{z as default};
