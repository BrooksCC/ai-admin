import{u as I,j as r}from"./index-JkWopOOq.js";import{r as o}from"./react-DR1zDSRy.js";import{A as N}from"./admin-service-BKkQARFc.js";import{C as Q}from"./CreateButton-CDCgXOSR.js";import{E as U,S as W}from"./SearchContainer-CfRQbxNb.js";import{S as X,a as j,b as Z,R as z}from"./SearchRow-C5yjr61H.js";import{u as ee,a as re,S as ne}from"./useTable-DmmfH85D.js";import{r as te,B as c,t as ie,A as se,F as t,S as D,I as s,c as ae,E as y,M as S,d as a,e as C}from"./antd-Sq0EuMdw.js";import"./echarts-C5AzJBXJ.js";import"./Button-C1yg5AiU.js";import"./useWindowSize-ncjCtajF.js";import"./useMutation-DAuBCnk0.js";import"./usePageTransfer-D2gnab3c.js";function me({noText:e,...f}){const{t:i}=I();return r.jsxDEV(te,{title:e?i("重新加载"):"",children:r.jsxDEV(c,{icon:r.jsxDEV(ie,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/components/button/ReloadButton.tsx",lineNumber:16,columnNumber:21},this),...f,children:!e&&i("重新加载")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/components/button/ReloadButton.tsx",lineNumber:16,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/components/button/ReloadButton.tsx",lineNumber:15,columnNumber:5},this)}function ve(){const{t:e}=I(),f=o.useRef(null),{message:i}=se.useApp(),[F,d]=o.useState(!1),[R,p]=o.useState(!1),[g]=t.useForm(),[b]=t.useForm(),[k,l]=o.useState(!1),[v,A]=o.useState(null);o.useEffect(()=>{const n=localStorage.getItem("user.token");console.log("当前token状态:",n?"已存在":"不存在",n?`${n.substring(0,15)}...`:"")},[]);async function O({page:n,pageSize:m,category:E}){console.log("正在请求配置列表...",{page:n,pageSize:m,category:E});try{const u=await N.getAllSettings(E),w=(n-1)*m,K=w+m,V=u.slice(w,K);return console.log("配置列表获取成功:",V),{list:V,total:u.length}}catch(u){return console.error("获取配置列表失败:",u),u instanceof Error?i.error(`获取配置列表失败: ${u.message}`):i.error("获取配置列表失败: 未知错误"),{list:[],total:0}}}const{listContainerProps:B,tableScrollY:T}=ee(),q=n=>{if(n==null)return"-";if(typeof n=="boolean")return e(n?"是":"否");try{return JSON.stringify(n)}catch{return String(n)}},{form:h,tableProps:M,isLoading:P,handleReset:_,refetch:x}=re({key:"settings-list",pagination:!0,listApiFn:O,scrollY:T,selectable:!1,formInitialValues:{key:null,category:null},columns:[{title:e("配置键名"),dataIndex:"key",width:200},{title:e("配置值"),dataIndex:"value",render:q,ellipsis:!0},{title:e("值类型"),dataIndex:"type",width:100},{title:e("描述"),dataIndex:"description",ellipsis:!0},{title:e("分类"),dataIndex:"category",width:120},{title:e("系统配置"),dataIndex:"isSystem",render:n=>e(n?"是":"否"),width:100},{title:e("操作"),key:"actions",fixed:"right",width:120,render:(n,m)=>r.jsxDEV(D,{children:r.jsxDEV(U,{type:"text",size:"small",noText:!0,onClick:()=>L(m)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:115,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:114,columnNumber:7},this)}]}),J=async()=>{try{l(!0),await N.reloadSettings(),i.success(e("配置已重新加载")),x()}catch(n){console.error("重新加载配置失败:",n),i.error(e("重新加载配置失败"))}finally{l(!1)}};function L(n){A(n),b.setFieldsValue({key:n.key,value:n.value,type:n.type,description:n.description,category:n.category,isSystem:n.isSystem}),p(!0)}async function Y(){try{if(!v)return;const n=await b.validateFields();l(!0);const m={value:n.value};await N.updateSetting(v.key,m),i.success(e("更新成功")),p(!1),x()}catch(n){console.error("更新配置失败:",n),i.error(e("更新失败"))}finally{l(!1)}}function $(){g.resetFields(),d(!0)}async function G(){try{const n=await g.validateFields();l(!0);const m={key:n.key,value:n.value,type:n.type,description:n.description,category:n.category,isSystem:n.isSystem||!1};await N.createSetting(m),i.success(e("创建成功")),d(!1),x()}catch(n){console.error("创建配置失败:",n),i.error(e("创建失败"))}finally{l(!1)}}const H=r.jsxDEV(t,{ref:f,form:h,colon:!1,autoComplete:"off",onFinish:()=>x(),children:r.jsxDEV(W,{actions:r.jsxDEV(D,{children:[r.jsxDEV(Z,{loading:P,onClick:()=>h.submit()},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:218,columnNumber:13},this),r.jsxDEV(z,{onClick:_},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:219,columnNumber:13},this),r.jsxDEV(Q,{onClick:$},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:220,columnNumber:13},this),r.jsxDEV(me,{onClick:J,loading:k},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:221,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:217,columnNumber:7},this),children:r.jsxDEV(X,{children:[r.jsxDEV(j,{name:"key",label:e("配置键名"),children:r.jsxDEV(s,{onPressEnter:()=>h.submit()},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:229,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:228,columnNumber:11},this),r.jsxDEV(j,{name:"category",label:e("分类"),children:r.jsxDEV(s,{onPressEnter:()=>h.submit()},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:232,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:231,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:227,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:215,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:208,columnNumber:3},this);return r.jsxDEV(r.Fragment,{children:[r.jsxDEV(ne,{...B,searchForm:H,children:r.jsxDEV(ae,{...M,locale:{emptyText:r.jsxDEV(y,{description:e("暂无配置数据"),image:y.PRESENTED_IMAGE_SIMPLE},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:245,columnNumber:24},this)}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:242,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:241,columnNumber:7},this),r.jsxDEV(S,{title:e("创建配置"),open:F,onCancel:()=>d(!1),footer:[r.jsxDEV(c,{onClick:()=>d(!1),children:e("取消")},"cancel",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:256,columnNumber:9},this),r.jsxDEV(c,{type:"primary",loading:k,onClick:G,children:e("确定")},"submit",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:259,columnNumber:9},this)],children:r.jsxDEV(t,{form:g,layout:"vertical",autoComplete:"off",initialValues:{isSystem:!1,type:"string"},children:[r.jsxDEV(t.Item,{name:"key",label:e("配置键名"),rules:[{required:!0,message:e("请输入配置键名")}],children:r.jsxDEV(s,{placeholder:e("例如: site.name")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:280,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:275,columnNumber:11},this),r.jsxDEV(t.Item,{name:"value",label:e("配置值"),rules:[{required:!0,message:e("请输入配置值")}],children:r.jsxDEV(s.TextArea,{rows:3,placeholder:e("请输入配置值")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:287,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:282,columnNumber:11},this),r.jsxDEV(t.Item,{name:"type",label:e("值类型"),rules:[{required:!0,message:e("请选择值类型")}],children:r.jsxDEV(a,{placeholder:e("请选择值类型"),children:[r.jsxDEV(a.Option,{value:"string",children:e("字符串")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:295,columnNumber:15},this),r.jsxDEV(a.Option,{value:"number",children:e("数字")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:296,columnNumber:15},this),r.jsxDEV(a.Option,{value:"boolean",children:e("布尔值")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:297,columnNumber:15},this),r.jsxDEV(a.Option,{value:"json",children:e("JSON对象")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:298,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:294,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:289,columnNumber:11},this),r.jsxDEV(t.Item,{name:"description",label:e("描述"),children:r.jsxDEV(s,{placeholder:e("请输入描述")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:305,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:301,columnNumber:11},this),r.jsxDEV(t.Item,{name:"category",label:e("分类"),rules:[{required:!0,message:e("请输入分类")}],children:r.jsxDEV(s,{placeholder:e("例如: general, api_keys")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:312,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:307,columnNumber:11},this),r.jsxDEV(t.Item,{name:"isSystem",label:e("系统配置"),valuePropName:"checked",children:r.jsxDEV(C,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:319,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:314,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:269,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:251,columnNumber:7},this),r.jsxDEV(S,{title:e("编辑配置"),open:R,onCancel:()=>p(!1),footer:[r.jsxDEV(c,{onClick:()=>p(!1),children:e("取消")},"cancel",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:330,columnNumber:9},this),r.jsxDEV(c,{type:"primary",loading:k,onClick:Y,children:e("确定")},"submit",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:333,columnNumber:9},this)],children:r.jsxDEV(t,{form:b,layout:"vertical",autoComplete:"off",children:[r.jsxDEV(t.Item,{name:"key",label:e("配置键名"),children:r.jsxDEV(s,{disabled:!0},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:352,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:348,columnNumber:11},this),r.jsxDEV(t.Item,{name:"value",label:e("配置值"),rules:[{required:!0,message:e("请输入配置值")}],children:r.jsxDEV(s.TextArea,{rows:3,placeholder:e("请输入配置值")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:359,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:354,columnNumber:12},this),r.jsxDEV(t.Item,{name:"type",label:e("值类型"),rules:[{required:!0,message:e("请选择值类型")}],children:r.jsxDEV(a,{placeholder:e("请选择值类型"),children:[r.jsxDEV(a.Option,{value:"string",children:e("字符串")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:367,columnNumber:15},this),r.jsxDEV(a.Option,{value:"number",children:e("数字")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:368,columnNumber:15},this),r.jsxDEV(a.Option,{value:"boolean",children:e("布尔值")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:369,columnNumber:15},this),r.jsxDEV(a.Option,{value:"json",children:e("JSON对象")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:370,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:366,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:361,columnNumber:11},this),r.jsxDEV(t.Item,{name:"description",label:e("描述"),children:r.jsxDEV(s,{placeholder:e("请输入描述")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:377,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:373,columnNumber:11},this),r.jsxDEV(t.Item,{name:"category",label:e("分类"),rules:[{required:!0,message:e("请输入分类")}],children:r.jsxDEV(s,{placeholder:e("例如: general, api_keys")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:384,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:379,columnNumber:11},this),r.jsxDEV(t.Item,{name:"isSystem",label:e("系统配置"),valuePropName:"checked",children:[r.jsxDEV(C,{disabled:!0},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:391,columnNumber:13},this)," "]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:386,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:343,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:325,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/settings/index.tsx",lineNumber:240,columnNumber:5},this)}export{ve as default};
