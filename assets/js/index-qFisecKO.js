import{j as e}from"./index-B7GDeRPa.js";import{r as f,e as ne,u as ae}from"./react-DR1zDSRy.js";import{A as x}from"./admin-preset-service-CByvltJG.js";import{G as me,M as oe,I as te,L as se}from"./LogitBiasEditor-BpRwacMU.js";import{PROMPT_ROLE_OPTIONS as I,INJECTION_POSITION_OPTIONS as ie}from"./types-Ccx87eRq.js";import{F as s,s as u,C as H,c as ue,B as p,r as de,S as E,t as ce,h as K,M as q,R as D,a as i,I as $,d as G,T as B,b as le,e as S,f as g,u as pe,v as fe,w as C,x as Ne,y as xe,z as ge,G as be,H as he,g as ke,i as U}from"./antd-DpIe9wCj.js";import"./echarts-C5AzJBXJ.js";const{TextArea:ve}=$,{Text:c,Paragraph:we}=K,Pe={system:"SYSTEM",user:"USER",assistant:"ASSISTANT"},De={SYSTEM:"system",USER:"user",ASSISTANT:"assistant"},Ee=({presetId:m,onPromptsChange:k})=>{var A,L;const[l,v]=f.useState([]),[R,j]=f.useState(!1),[O,w]=f.useState(!1),[F,P]=f.useState(!1),[a,V]=f.useState(null),[b]=s.useForm(),o=f.useCallback(async()=>{j(!0);try{const n=((await x.getPresetPrompts(m)).prompts||[]).map(t=>({...t,role:De[t.role]||"system"}));v(n),k==null||k(n)}catch(r){console.error("Failed to fetch prompts:",r),u.error("获取提示词列表失败")}finally{j(!1)}},[m,k]);f.useEffect(()=>{m&&o()},[m,o]);const d=()=>{V(null),b.resetFields(),b.setFieldsValue({role:"system",systemPrompt:!0,marker:!1,injectionPosition:0,injectionDepth:4,injectionOrder:100,forbidOverrides:!1,enabled:!0,extension:!1,sortOrder:l.length}),w(!0)},M=r=>{V(r),b.setFieldsValue(r),w(!0)},z=r=>{V(r),P(!0)},Y=async r=>{try{const n={name:`${r.name} (副本)`,identifier:`${r.identifier}_copy_${Date.now()}`};await x.duplicatePrompt(m,r.id,n),u.success("提示词复制成功"),o()}catch(n){console.error("Failed to duplicate prompt:",n),u.error("复制提示词失败")}},J=async r=>{try{await x.deletePrompt(m,r),u.success("提示词删除成功"),o()}catch(n){console.error("Failed to delete prompt:",n),u.error("删除提示词失败")}},W=async(r,n)=>{try{n?await x.enablePrompt(m,r.id):await x.disablePrompt(m,r.id),u.success(`提示词已${n?"启用":"禁用"}`),o()}catch(t){console.error("Failed to toggle prompt:",t),u.error("操作失败")}},Q=async()=>{try{const r=await b.validateFields(),n={...r,role:Pe[r.role]};a?(await x.updatePrompt(m,a.id,n),u.success("提示词更新成功")):(await x.createPrompt(m,n),u.success("提示词创建成功")),w(!1),o()}catch(r){console.error("Failed to save prompt:",r),u.error("保存提示词失败")}},_=async(r,n)=>{const t=l.findIndex(y=>y.id===r);if(t===-1)return;const h=n==="up"?t-1:t+1;if(h<0||h>=l.length)return;const N=[...l];[N[t],N[h]]=[N[h],N[t]],v(N);try{const y={promptIds:N.map(re=>re.id)};await x.reorderPrompts(m,y),u.success("排序已保存")}catch(y){console.error("Failed to reorder prompts:",y),u.error("保存排序失败"),o()}},X=r=>r.marker?"📌":r.systemPrompt&&!r.forbidOverrides?"📊":r.systemPrompt&&r.forbidOverrides?"⭐":!r.systemPrompt&&r.injectionPosition===1?"💉":"✱",Z=r=>r.marker?"标记":r.systemPrompt&&!r.forbidOverrides?"全局提示词":r.systemPrompt&&r.forbidOverrides?"重要提示词":!r.systemPrompt&&r.injectionPosition===1?"聊天注入":"预设提示词",ee=[{title:"ID",dataIndex:"id",key:"id",width:80,render:(r,n)=>e.jsxDEV("a",{onClick:()=>M(n),style:{fontSize:"12px",fontFamily:"monospace"},children:r.slice(-6)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:256,columnNumber:5},void 0)},{title:"排序",key:"sort",width:80,render:(r,n,t)=>e.jsxDEV(E,{children:[e.jsxDEV(p,{type:"text",icon:e.jsxDEV(pe,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:272,columnNumber:15},void 0),size:"small",disabled:t===0,onClick:()=>_(n.id,"up")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:270,columnNumber:11},void 0),e.jsxDEV(p,{type:"text",icon:e.jsxDEV(fe,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:279,columnNumber:15},void 0),size:"small",disabled:t===l.length-1,onClick:()=>_(n.id,"down")},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:277,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:269,columnNumber:5},void 0)},{title:"名称",dataIndex:"name",key:"name",width:200,render:(r,n)=>{var t,h;return e.jsxDEV(E,{children:[e.jsxDEV(C,{title:Z(n),children:e.jsxDEV("span",{style:{fontSize:"16px"},children:X(n)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:295,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:294,columnNumber:11},void 0),e.jsxDEV(p,{type:"link",onClick:()=>z(n),style:{padding:0},children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:297,columnNumber:11},void 0),e.jsxDEV(g,{color:(t=I.find(N=>N.value===n.role))==null?void 0:t.color,children:(h=I.find(N=>N.value===n.role))==null?void 0:h.label},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:300,columnNumber:11},void 0),n.injectionPosition===1&&e.jsxDEV(g,{color:"purple",children:["@",n.injectionDepth]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:304,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:293,columnNumber:5},void 0)}},{title:"标识符",dataIndex:"identifier",key:"identifier",width:150,render:r=>e.jsxDEV(c,{code:!0,children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:317,columnNumber:31},void 0)},{title:"状态",dataIndex:"enabled",key:"enabled",width:80,render:(r,n)=>e.jsxDEV(S,{checked:r,onChange:t=>W(n,t),size:"small"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:325,columnNumber:5},void 0)},{title:"令牌",key:"tokens",width:80,render:()=>e.jsxDEV(c,{type:"secondary",children:"-"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:336,columnNumber:19},void 0)},{title:"操作",key:"actions",width:150,render:(r,n)=>e.jsxDEV(E,{size:"small",children:[e.jsxDEV(C,{title:"查看",children:e.jsxDEV(p,{type:"text",icon:e.jsxDEV(Ne,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:347,columnNumber:17},void 0),onClick:()=>z(n),size:"small"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:345,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:344,columnNumber:11},void 0),e.jsxDEV(C,{title:"编辑",children:e.jsxDEV(p,{type:"text",icon:e.jsxDEV(xe,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:355,columnNumber:17},void 0),onClick:()=>M(n),size:"small"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:353,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:352,columnNumber:11},void 0),e.jsxDEV(C,{title:"复制",children:e.jsxDEV(p,{type:"text",icon:e.jsxDEV(ge,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:363,columnNumber:17},void 0),onClick:()=>Y(n),size:"small"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:361,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:360,columnNumber:11},void 0),e.jsxDEV(C,{title:"删除",children:e.jsxDEV(be,{title:"确定要删除这个提示词吗？",onConfirm:()=>J(n.id),okText:"确定",cancelText:"取消",children:e.jsxDEV(p,{type:"text",icon:e.jsxDEV(he,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:377,columnNumber:19},void 0),danger:!0,size:"small"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:375,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:369,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:368,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:343,columnNumber:5},void 0)}];return e.jsxDEV("div",{children:[e.jsxDEV(H,{title:e.jsxDEV(E,{children:[e.jsxDEV(ce,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:393,columnNumber:13},void 0),e.jsxDEV("span",{children:"提示词管理"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:394,columnNumber:13},void 0),e.jsxDEV(c,{type:"secondary",children:["(",l.length," ","个提示词)"]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:395,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:392,columnNumber:9},void 0),extra:e.jsxDEV(p,{type:"primary",icon:e.jsxDEV(de,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:404,columnNumber:38},void 0),onClick:d,children:"添加提示词"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:404,columnNumber:9},void 0),children:e.jsxDEV(ue,{rowKey:"id",columns:ee,dataSource:l,loading:R,pagination:!1,size:"small"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:409,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:390,columnNumber:7},void 0),e.jsxDEV(q,{title:a?"编辑提示词":"创建提示词",open:O,onCancel:()=>w(!1),onOk:Q,width:800,destroyOnClose:!0,children:e.jsxDEV(s,{form:b,layout:"vertical",children:[e.jsxDEV(D,{gutter:16,children:[e.jsxDEV(i,{span:12,children:e.jsxDEV(s.Item,{name:"name",label:"名称",rules:[{required:!0,message:"请输入提示词名称"}],children:e.jsxDEV($,{placeholder:"请输入提示词名称"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:436,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:431,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:430,columnNumber:13},void 0),e.jsxDEV(i,{span:12,children:e.jsxDEV(s.Item,{name:"identifier",label:"标识符",rules:[{required:!0,message:"请输入标识符"}],children:e.jsxDEV($,{placeholder:"请输入唯一标识符"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:445,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:440,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:439,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:429,columnNumber:11},void 0),e.jsxDEV(s.Item,{name:"content",label:"内容",rules:[{required:!0,message:"请输入提示词内容"}],children:e.jsxDEV(ve,{rows:8,placeholder:"请输入提示词内容",showCount:!0},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:455,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:450,columnNumber:11},void 0),e.jsxDEV(D,{gutter:16,children:[e.jsxDEV(i,{span:8,children:e.jsxDEV(s.Item,{name:"role",label:"角色",children:e.jsxDEV(G,{options:I},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:465,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:464,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:463,columnNumber:13},void 0),e.jsxDEV(i,{span:8,children:e.jsxDEV(s.Item,{name:"injectionPosition",label:"注入位置",children:e.jsxDEV(G,{options:ie},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:470,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:469,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:468,columnNumber:13},void 0),e.jsxDEV(i,{span:8,children:e.jsxDEV(s.Item,{name:"injectionDepth",label:"注入深度",children:e.jsxDEV(B,{min:0,max:100,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:475,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:474,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:473,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:462,columnNumber:11},void 0),e.jsxDEV(D,{gutter:16,children:[e.jsxDEV(i,{span:8,children:e.jsxDEV(s.Item,{name:"injectionOrder",label:"注入顺序",children:e.jsxDEV(B,{min:0,max:1e3,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:483,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:482,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:481,columnNumber:13},void 0),e.jsxDEV(i,{span:8,children:e.jsxDEV(s.Item,{name:"sortOrder",label:"排序",children:e.jsxDEV(B,{min:0,style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:488,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:487,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:486,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:480,columnNumber:11},void 0),e.jsxDEV(le,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:493,columnNumber:11},void 0),e.jsxDEV(D,{gutter:16,children:[e.jsxDEV(i,{span:6,children:e.jsxDEV(s.Item,{name:"systemPrompt",valuePropName:"checked",children:e.jsxDEV(S,{checkedChildren:"系统提示词",unCheckedChildren:"普通提示词"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:498,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:497,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:496,columnNumber:13},void 0),e.jsxDEV(i,{span:6,children:e.jsxDEV(s.Item,{name:"marker",valuePropName:"checked",children:e.jsxDEV(S,{checkedChildren:"标记",unCheckedChildren:"非标记"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:503,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:502,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:501,columnNumber:13},void 0),e.jsxDEV(i,{span:6,children:e.jsxDEV(s.Item,{name:"forbidOverrides",valuePropName:"checked",children:e.jsxDEV(S,{checkedChildren:"禁止覆盖",unCheckedChildren:"允许覆盖"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:508,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:507,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:506,columnNumber:13},void 0),e.jsxDEV(i,{span:6,children:e.jsxDEV(s.Item,{name:"enabled",valuePropName:"checked",children:e.jsxDEV(S,{checkedChildren:"启用",unCheckedChildren:"禁用"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:513,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:512,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:511,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:495,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:428,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:420,columnNumber:7},void 0),e.jsxDEV(q,{title:`查看提示词: ${a==null?void 0:a.name}`,open:F,onCancel:()=>P(!1),footer:[e.jsxDEV(p,{onClick:()=>P(!1),children:"关闭"},"close",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:526,columnNumber:9},void 0),e.jsxDEV(p,{type:"primary",onClick:()=>{P(!1),M(a)},children:"编辑"},"edit",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:529,columnNumber:9},void 0)],width:800,children:a&&e.jsxDEV("div",{children:[e.jsxDEV(D,{gutter:16,style:{marginBottom:16},children:[e.jsxDEV(i,{span:12,children:[e.jsxDEV(c,{strong:!0,children:"标识符: "},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:546,columnNumber:17},void 0),e.jsxDEV(c,{code:!0,children:a.identifier},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:547,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:545,columnNumber:15},void 0),e.jsxDEV(i,{span:12,children:[e.jsxDEV(c,{strong:!0,children:"角色: "},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:550,columnNumber:17},void 0),e.jsxDEV(g,{color:(A=I.find(r=>r.value===a.role))==null?void 0:A.color,children:(L=I.find(r=>r.value===a.role))==null?void 0:L.label},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:551,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:549,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:544,columnNumber:13},void 0),e.jsxDEV(D,{gutter:16,style:{marginBottom:16},children:[e.jsxDEV(i,{span:8,children:[e.jsxDEV(c,{strong:!0,children:"注入位置: "},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:559,columnNumber:17},void 0),e.jsxDEV(c,{children:a.injectionPosition===0?"相对位置":"绝对位置"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:560,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:558,columnNumber:15},void 0),e.jsxDEV(i,{span:8,children:[e.jsxDEV(c,{strong:!0,children:"注入深度: "},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:563,columnNumber:17},void 0),e.jsxDEV(c,{children:a.injectionDepth},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:564,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:562,columnNumber:15},void 0),e.jsxDEV(i,{span:8,children:[e.jsxDEV(c,{strong:!0,children:"注入顺序: "},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:567,columnNumber:17},void 0),e.jsxDEV(c,{children:a.injectionOrder},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:568,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:566,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:557,columnNumber:13},void 0),e.jsxDEV("div",{style:{marginBottom:16},children:[e.jsxDEV(c,{strong:!0,children:"内容:"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:573,columnNumber:15},void 0),e.jsxDEV("div",{style:{marginTop:8,padding:12,border:"1px solid #d9d9d9",borderRadius:6,backgroundColor:"#fafafa",maxHeight:300,overflow:"auto"},children:e.jsxDEV(we,{style:{margin:0,whiteSpace:"pre-wrap"},children:a.content},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:584,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:574,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:572,columnNumber:13},void 0),e.jsxDEV(E,{children:[e.jsxDEV(g,{color:a.enabled?"green":"red",children:a.enabled?"已启用":"已禁用"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:591,columnNumber:15},void 0),a.systemPrompt&&e.jsxDEV(g,{color:"blue",children:"系统提示词"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:594,columnNumber:46},void 0),a.marker&&e.jsxDEV(g,{color:"orange",children:"标记"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:595,columnNumber:40},void 0),a.forbidOverrides&&e.jsxDEV(g,{color:"purple",children:"禁止覆盖"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:596,columnNumber:49},void 0),a.extension&&e.jsxDEV(g,{color:"cyan",children:"扩展"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:597,columnNumber:43},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:590,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:543,columnNumber:9},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:521,columnNumber:7},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/components/form/PromptManager.tsx",lineNumber:389,columnNumber:5},void 0)},{Title:je}=K,{TabPane:T}=U,Oe=()=>{const{id:m}=ne(),k=ae(),[l]=s.useForm(),[v,R]=f.useState(null),[j,O]=f.useState(!0),[w,F]=f.useState(!1),P=s.useWatch("type",l),a=async()=>{if(m){O(!0);try{const o=await x.findPresetById(m),d={...o,description:o.description||void 0,tags:o.tags||[]};R(d);const M={...d,instructModeData:d.instructModeData?{...d.instructModeData}:void 0,logitBias:d.logitBias?[...d.logitBias]:void 0,tags:d.tags?[...d.tags]:[],stop:d.stop?[...d.stop]:[]};l.setFieldsValue(M)}catch(o){console.error("Failed to fetch preset details:",o),u.error("获取预设详情失败")}finally{O(!1)}}};f.useEffect(()=>{a()},[m]);const V=async()=>{if(!(!m||!v))try{F(!0);const o=await l.validateFields(),d={...o,type:o.type};await x.updatePreset(m,d),u.success("预设更新成功"),await a()}catch(o){console.error("Failed to save preset:",o),u.error("保存预设失败，请检查表单或联系管理员")}finally{F(!1)}},b=()=>{k("/preset")};return e.jsxDEV("div",{style:{padding:"24px"},children:e.jsxDEV(E,{direction:"vertical",style:{width:"100%"},size:"large",children:[e.jsxDEV("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px"},children:[e.jsxDEV(p,{icon:e.jsxDEV(ke,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:99,columnNumber:19},void 0),onClick:b,style:{marginRight:"16px"},children:"返回列表"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:98,columnNumber:11},void 0),e.jsxDEV(je,{level:3,style:{marginBottom:0},children:v?`编辑预设: ${v.name}`:"编辑预设"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:105,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:97,columnNumber:9},void 0),e.jsxDEV(H,{loading:j,children:e.jsxDEV(s,{form:l,layout:"vertical",name:"preset_edit_form",children:e.jsxDEV(U,{defaultActiveKey:"1",tabBarExtraContent:e.jsxDEV(p,{type:"primary",loading:w,onClick:V,disabled:j,children:"保存更改"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:116,columnNumber:15},void 0),children:[e.jsxDEV(T,{tab:"通用设置",children:e.jsxDEV(me,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:127,columnNumber:17},void 0)},"1",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:126,columnNumber:15},void 0),e.jsxDEV(T,{tab:"模型参数",children:e.jsxDEV(oe,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:130,columnNumber:17},void 0)},"2",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:129,columnNumber:15},void 0),P==="instruct"&&e.jsxDEV(T,{tab:"指令设置",children:e.jsxDEV(te,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:134,columnNumber:19},void 0)},"3",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:133,columnNumber:15},void 0),e.jsxDEV(T,{tab:"Logit Bias",children:e.jsxDEV(se,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:138,columnNumber:17},void 0)},"4",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:137,columnNumber:15},void 0),e.jsxDEV(T,{tab:"提示词管理",children:e.jsxDEV(Ee,{presetId:m},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:141,columnNumber:17},void 0)},"5",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:140,columnNumber:15},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:113,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:112,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:111,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:95,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/preset/[id]/index.tsx",lineNumber:94,columnNumber:5},void 0)};export{Oe as default};
