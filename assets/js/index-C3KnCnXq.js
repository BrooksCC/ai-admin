import{j as e}from"./index-Cvcm6e8Y.js";import{e as de,u as ae,r as t}from"./react-DR1zDSRy.js";import{W as l}from"./worldinfo-service-yWLoyq7P.js";import{F as o,M,I as h,R as T,a as u,d as V,l as f,T as le,B as c,i as me,f as g,j as K,C as B,L as b,b as G,s as i,S as R,v as O,c as se,w as ue,e as te,x as ce,y as fe}from"./antd-CDJKHjm9.js";import"./echarts-C5AzJBXJ.js";const{Option:D}=V,pe=({visible:d,onCancel:m,onOk:E,initialValues:w,title:p})=>{const[N]=o.useForm(),j=()=>{N.validateFields().then(x=>{N.resetFields(),E(x)}).catch(x=>{console.log("Validate Failed:",x)})};return e.jsxDEV(M,{open:d,title:p,onCancel:m,onOk:j,width:800,destroyOnClose:!0,children:e.jsxDEV(o,{form:N,layout:"vertical",initialValues:w||{selective:!0,priority:100,constant:!1,disable:!1,caseSensitive:!1,searchRange:"Global",regex:!1,groupScore:"None",automationId:""},children:[e.jsxDEV(o.Item,{name:"name",label:"名称",rules:[{required:!0,message:"请输入名称"}],children:e.jsxDEV(h,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:45,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:44,columnNumber:9},void 0),e.jsxDEV(o.Item,{name:"keys",label:"主要关键字 (逗号分隔)",rules:[{required:!0,message:"请输入关键字"}],children:e.jsxDEV(h,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:48,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:47,columnNumber:9},void 0),e.jsxDEV(T,{gutter:16,children:[e.jsxDEV(u,{span:8,children:e.jsxDEV(o.Item,{name:"searchRange",label:"扫描深度",children:e.jsxDEV(V,{children:[e.jsxDEV(D,{value:"Global",children:"使用全局设置"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:54,columnNumber:25},void 0),e.jsxDEV(D,{value:"Character",children:"角色定义"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:55,columnNumber:25},void 0),e.jsxDEV(D,{value:"Memory",children:"记忆"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:56,columnNumber:25},void 0),e.jsxDEV(D,{value:"ChatHistory",children:"聊天记录"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:57,columnNumber:25},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:53,columnNumber:21},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:52,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:51,columnNumber:13},void 0),e.jsxDEV(u,{span:8,children:e.jsxDEV(o.Item,{name:"caseSensitive",label:"区分大小写",valuePropName:"checked",children:e.jsxDEV(f,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:63,columnNumber:22},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:62,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:61,columnNumber:14},void 0),e.jsxDEV(u,{span:8,children:e.jsxDEV(o.Item,{name:"regex",label:"Whole Words",valuePropName:"checked",children:e.jsxDEV(f,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:68,columnNumber:21},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:67,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:66,columnNumber:14},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:50,columnNumber:9},void 0),e.jsxDEV(o.Item,{name:"content",label:"内容",rules:[{required:!0,message:"请输入内容"}],children:e.jsxDEV(h.TextArea,{rows:6},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:73,columnNumber:11},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:72,columnNumber:9},void 0),e.jsxDEV(T,{gutter:16,children:[e.jsxDEV(u,{span:8,children:e.jsxDEV(o.Item,{name:"disable",valuePropName:"checked",children:e.jsxDEV(f,{children:"不可递归"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:78,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:77,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:76,columnNumber:11},void 0),e.jsxDEV(u,{span:8,children:e.jsxDEV(o.Item,{name:"prevent_recursion",valuePropName:"checked",children:e.jsxDEV(f,{children:"防止进一步递归"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:83,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:82,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:81,columnNumber:11},void 0),e.jsxDEV(u,{span:8,children:e.jsxDEV(o.Item,{name:"delay_recursion",valuePropName:"checked",children:e.jsxDEV(f,{children:"延迟到递归"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:88,columnNumber:15},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:87,columnNumber:14},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:86,columnNumber:11},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:75,columnNumber:9},void 0),e.jsxDEV(T,{gutter:16,children:[e.jsxDEV(u,{span:6,children:e.jsxDEV(o.Item,{label:"确定优先极",children:e.jsxDEV(f,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:95,columnNumber:21},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:94,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:93,columnNumber:13},void 0),e.jsxDEV(u,{span:6,children:e.jsxDEV(o.Item,{name:"priority",label:"组权重",children:e.jsxDEV(le,{style:{width:"100%"}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:100,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:99,columnNumber:18},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:98,columnNumber:13},void 0),e.jsxDEV(u,{span:6,children:e.jsxDEV(o.Item,{label:"黏性",children:e.jsxDEV(f,{children:"无黏性"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:105,columnNumber:22},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:104,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:103,columnNumber:13},void 0),e.jsxDEV(u,{span:6,children:e.jsxDEV(o.Item,{label:"排除",children:e.jsxDEV(f,{children:"排除"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:110,columnNumber:22},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:109,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:108,columnNumber:14},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:92,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:39,columnNumber:7},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/components/WorldInfoEntryForm.tsx",lineNumber:31,columnNumber:5},void 0)},{Title:I}=me,{Option:Ne}=V,{TabPane:P}=K,H=[{value:"GLOBAL",label:"全局世界书",description:"适用于所有对话的通用信息",color:"blue"},{value:"CHARACTER",label:"角色世界书",description:"特定角色相关的背景信息",color:"green"},{value:"CHAT",label:"对话世界书",description:"特定对话场景的信息",color:"orange"},{value:"PERSONA",label:"个人世界书",description:"个人角色设定信息",color:"purple"},{value:"USER",label:"用户自定义",description:"用户自定义的世界信息",color:"default"}],Ee=()=>{var z;const{id:d}=de(),m=ae(),[E]=o.useForm(),[w]=o.useForm(),[p,N]=t.useState(null),[j,x]=t.useState([]),[a,U]=t.useState(null),[A,L]=t.useState(!0),[Y,_]=t.useState(!1),[q,F]=t.useState(!1),[J,y]=t.useState(!1),[s,Q]=t.useState("character"),k=async()=>{if(!d){i.error("世界信息ID不存在"),m("/worldinfo");return}L(!0);try{console.log("Fetching world info details for ID:",d);const r=await l.getWorldInfoById(d);console.log("World info fetched:",r),N(r),E.setFieldsValue({name:r.name,description:r.description,type:r.type});try{const n=await l.getWorldInfoEntries(d);console.log("Entries fetched:",n),x(n)}catch(n){console.error("Failed to fetch entries:",n),i.warning("获取世界信息条目失败，但主要信息已加载"),x([])}}catch(r){console.error("Failed to fetch world info details:",r),r instanceof Error?r.message.includes("404")||r.message.includes("Not Found")?(i.error("世界信息不存在，可能已被删除"),m("/worldinfo")):r.message.includes("403")||r.message.includes("Forbidden")?(i.error("没有权限访问此世界信息"),m("/worldinfo")):r.message.includes("Network Error")||r.message.includes("timeout")?i.error("网络连接失败，请检查网络连接"):i.error(`获取世界信息详情失败: ${r.message}`):i.error("获取世界信息详情失败，请稍后重试")}finally{L(!1)}},W=async()=>{if(d){_(!0);try{console.log("Fetching bindings for world info ID:",d);const r=await l.getWorldInfoBindings(d);console.log("Bindings fetched:",r),U(r)}catch(r){console.error("Failed to fetch bindings:",r),i.warning("获取绑定信息失败")}finally{_(!1)}}};t.useEffect(()=>{k(),W()},[d]);const X=async r=>{if(!d||!p){i.error("世界信息数据不完整");return}try{const n={...r};console.log("Updating world info with:",n),await l.updateWorldInfo(d,n),i.success("世界信息更新成功！"),N(v=>v?{...v,name:r.name,description:r.description,type:r.type}:null)}catch(n){console.error("Failed to update world info:",n),n instanceof Error?i.error(`更新世界信息失败: ${n.message}`):i.error("更新世界信息失败，请稍后重试")}},Z=()=>{F(!0)},C=r=>{Q(r),y(!0),w.resetFields()},ee=r=>{if(!d){i.error("世界信息ID不存在");return}M.confirm({title:"确定要删除此条目吗？",content:"删除后无法恢复",onOk:async()=>{try{await l.deleteWorldInfoEntry(d,r),i.success("条目删除成功"),k()}catch(n){console.error("Failed to delete entry:",n),n instanceof Error?i.error(`删除条目失败: ${n.message}`):i.error("删除条目失败，请稍后重试")}}})},re=async r=>{if(!d){i.error("世界信息ID不存在");return}try{console.log("Creating entry with values:",r),await l.createWorldInfoEntry(d,r),i.success("条目创建成功"),F(!1),k()}catch(n){console.error("Failed to create entry:",n),n instanceof Error?i.error(`创建条目失败: ${n.message}`):i.error("创建条目失败，请稍后重试")}},ne=async r=>{if(!d){i.error("世界信息ID不存在");return}try{s==="character"?(await l.associateWithCharacter(d,r.targetId),i.success("成功绑定到角色")):s==="story"?(await l.associateWithStory(d,r.targetId),i.success("成功绑定到故事")):(await l.associateWithVirtualModel(d,r.targetId),i.success("成功绑定到虚拟模型")),y(!1),w.resetFields(),W()}catch(n){console.error("Failed to create binding:",n),n instanceof Error?i.error(`绑定失败: ${n.message}`):i.error("绑定失败，请稍后重试")}},ie=()=>p?H.find(r=>r.value===p.type):null,oe=[{title:"ID",dataIndex:"id",key:"id",width:280,ellipsis:!0,render:(r,n)=>e.jsxDEV("a",{onClick:()=>m(`/worldinfo/${d}/${n.id}`),children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:253,columnNumber:5},void 0)},{title:"Keywords",dataIndex:"keys",key:"keys",render:r=>Array.isArray(r)?r.join(", "):""},{title:"备忘",dataIndex:"comment",key:"comment",ellipsis:!0},{title:"插入位置",dataIndex:"position",key:"position",render:r=>r==="before_char"?"角色定义之前":r==="after_char"?"角色定义之后":r},{title:"深度",dataIndex:"scanDepth",key:"scanDepth"},{title:"顺序",dataIndex:"order",key:"order"},{title:"触发概率",dataIndex:"probability",key:"probability",render:r=>`${r??100}%`},{title:"启用状态",dataIndex:"enabled",key:"enabled",render:(r,n)=>e.jsxDEV(te,{checked:r,checkedChildren:"启用",unCheckedChildren:"禁用",onChange:async v=>{try{await l.updateWorldInfoEntry(d,n.id,{enabled:v}),i.success("状态更新成功"),k()}catch($){console.error("Failed to update entry status:",$),$ instanceof Error?i.error(`状态更新失败: ${$.message}`):i.error("状态更新失败，请稍后重试")}}},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:278,columnNumber:5},void 0)},{title:"操作",key:"action",render:(r,n)=>e.jsxDEV(R,{size:"middle",children:[e.jsxDEV(ce,{style:{cursor:"pointer"},onClick:()=>m(`/worldinfo/${d}/${n.id}`)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:304,columnNumber:21},void 0),e.jsxDEV(fe,{style:{color:"red",cursor:"pointer"},onClick:()=>ee(n.id)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:305,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:303,columnNumber:5},void 0)}],S=ie();return e.jsxDEV("div",{children:[e.jsxDEV("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px"},children:[e.jsxDEV(c,{onClick:()=>m("/worldinfo"),style:{marginRight:"16px"},children:"返回"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:316,columnNumber:17},void 0),e.jsxDEV(I,{level:4,style:{marginBottom:0},children:p?`编辑世界信息: ${p.name}`:"编辑世界信息"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:319,columnNumber:17},void 0),S&&e.jsxDEV(g,{color:S.color,style:{marginLeft:"16px"},children:S.label},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:323,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:315,columnNumber:13},void 0),e.jsxDEV(K,{defaultActiveKey:"1",children:[e.jsxDEV(P,{tab:"基本信息",children:e.jsxDEV(B,{title:"基本信息",loading:A,children:e.jsxDEV(o,{form:E,layout:"vertical",onFinish:X,children:[e.jsxDEV(o.Item,{name:"name",label:"名称",rules:[{required:!0,message:"请输入名称"}],children:e.jsxDEV(h,{placeholder:"请输入世界信息名称"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:334,columnNumber:33},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:333,columnNumber:29},void 0),e.jsxDEV(o.Item,{name:"type",label:"类型",rules:[{required:!0,message:"请选择世界书类型"}],children:e.jsxDEV(V,{placeholder:"请选择世界书类型",children:H.map(r=>e.jsxDEV(Ne,{value:r.value,children:e.jsxDEV("div",{children:[e.jsxDEV(g,{color:r.color,style:{marginRight:"8px"},children:r.label},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:346,columnNumber:49},void 0),e.jsxDEV("span",{style:{fontSize:"12px",color:"#666"},children:r.description},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:349,columnNumber:49},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:345,columnNumber:45},void 0)},r.value,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:344,columnNumber:19},void 0))},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:342,columnNumber:33},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:337,columnNumber:29},void 0),e.jsxDEV(o.Item,{name:"description",label:"描述",children:e.jsxDEV(h.TextArea,{rows:4,placeholder:"请输入世界信息描述（可选）"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:359,columnNumber:33},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:358,columnNumber:29},void 0),e.jsxDEV(o.Item,{children:e.jsxDEV(c,{type:"primary",htmlType:"submit",children:"保存修改"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:365,columnNumber:33},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:364,columnNumber:29},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:332,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:331,columnNumber:21},void 0)},"1",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:330,columnNumber:17},void 0),e.jsxDEV(P,{tab:"绑定信息",children:e.jsxDEV(B,{title:"绑定信息",loading:Y,extra:e.jsxDEV(R,{children:[e.jsxDEV(c,{type:"primary",icon:e.jsxDEV(O,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:381,columnNumber:23},void 0),onClick:()=>C("character"),children:"绑定角色"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:379,columnNumber:33},void 0),e.jsxDEV(c,{type:"primary",icon:e.jsxDEV(O,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:388,columnNumber:23},void 0),onClick:()=>C("story"),children:"绑定故事"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:386,columnNumber:33},void 0),e.jsxDEV(c,{type:"primary",icon:e.jsxDEV(O,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:395,columnNumber:23},void 0),onClick:()=>C("virtualModel"),children:"绑定参数集"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:393,columnNumber:33},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:378,columnNumber:13},void 0),children:a&&e.jsxDEV("div",{children:[e.jsxDEV("div",{style:{marginBottom:"16px"},children:[e.jsxDEV(I,{level:5,children:["绑定的角色 (",a.characterIds.length,")"]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:406,columnNumber:37},void 0),a.characterIds.length>0?e.jsxDEV(b,{size:"small",dataSource:a.characterIds,renderItem:r=>e.jsxDEV(b.Item,{children:e.jsxDEV(g,{color:"green",style:{cursor:"pointer"},onClick:()=>m(`/card/${r}`),children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:418,columnNumber:53},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:417,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:413,columnNumber:17},void 0):e.jsxDEV("div",{style:{color:"#999",fontStyle:"italic"},children:"暂无绑定的角色"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:430,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:405,columnNumber:33},void 0),e.jsxDEV(G,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:434,columnNumber:33},void 0),e.jsxDEV("div",{children:[e.jsxDEV(I,{level:5,children:["绑定的故事 (",a.storyIds.length,")"]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:437,columnNumber:37},void 0),a.storyIds.length>0?e.jsxDEV(b,{size:"small",dataSource:a.storyIds,renderItem:r=>e.jsxDEV(b.Item,{children:e.jsxDEV(g,{color:"orange",children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:449,columnNumber:53},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:448,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:444,columnNumber:17},void 0):e.jsxDEV("div",{style:{color:"#999",fontStyle:"italic"},children:"暂无绑定的故事"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:455,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:436,columnNumber:33},void 0),e.jsxDEV(G,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:459,columnNumber:33},void 0),e.jsxDEV("div",{children:[e.jsxDEV(I,{level:5,children:["绑定的参数集 -虚拟模型 (",((z=a.modelParameterIds)==null?void 0:z.length)||0,")"]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:462,columnNumber:37},void 0),a.modelParameterIds&&a.modelParameterIds.length>0?e.jsxDEV(b,{size:"small",dataSource:a.modelParameterIds,renderItem:r=>e.jsxDEV(b.Item,{actions:[e.jsxDEV(c,{type:"link",size:"small",danger:!0,onClick:async()=>{try{await l.unbindFromVirtualModel(d),i.success("成功解绑参数集"),W()}catch(n){console.error("Failed to unbind virtual model:",n),i.error("解绑参数集失败")}},children:"解绑"},"unbind",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:475,columnNumber:21},void 0)],children:e.jsxDEV(g,{color:"purple",style:{cursor:"pointer"},onClick:()=>m(`/modelparameter/${r}/edit`),children:r},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:495,columnNumber:53},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:473,columnNumber:19},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:469,columnNumber:17},void 0):e.jsxDEV("div",{style:{color:"#999",fontStyle:"italic"},children:"暂无绑定的参数集"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:507,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:461,columnNumber:33},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:404,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:374,columnNumber:21},void 0)},"2",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:373,columnNumber:17},void 0),e.jsxDEV(P,{tab:"条目列表",children:e.jsxDEV(B,{title:"条目列表",extra:e.jsxDEV(c,{type:"primary",icon:e.jsxDEV(ue,{},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:518,columnNumber:49},void 0),onClick:Z,children:"添加条目"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:518,columnNumber:20},void 0),children:e.jsxDEV(se,{columns:oe,dataSource:j,rowKey:"id",loading:A},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:520,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:516,columnNumber:21},void 0)},"3",!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:515,columnNumber:17},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:329,columnNumber:13},void 0),q&&e.jsxDEV(pe,{visible:q,onCancel:()=>F(!1),onOk:re,initialValues:null,title:"添加条目"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:532,columnNumber:7},void 0),e.jsxDEV(M,{title:`绑定到${s==="character"?"角色":s==="story"?"故事":"参数集"}`,open:J,onCancel:()=>y(!1),footer:null,children:e.jsxDEV(o,{form:w,layout:"vertical",onFinish:ne,children:[e.jsxDEV(o.Item,{name:"targetId",label:`${s==="character"?"角色":s==="story"?"故事":"参数集"}ID`,rules:[{required:!0,message:`请输入要绑定的${s==="character"?"角色":s==="story"?"故事":"参数集"}ID`}],children:e.jsxDEV(h,{placeholder:`请输入要绑定的${s==="character"?"角色":s==="story"?"故事":"参数集"}ID`},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:558,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:553,columnNumber:21},void 0),e.jsxDEV(o.Item,{children:e.jsxDEV(R,{children:[e.jsxDEV(c,{type:"primary",htmlType:"submit",children:"确认绑定"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:562,columnNumber:29},void 0),e.jsxDEV(c,{onClick:()=>y(!1),children:"取消"},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:565,columnNumber:29},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:561,columnNumber:25},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:560,columnNumber:21},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:548,columnNumber:17},void 0)},void 0,!1,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:542,columnNumber:13},void 0)]},void 0,!0,{fileName:"/home/runner/work/pure-admin-react/pure-admin-react/src/pages/worldinfo/[id]/index.tsx",lineNumber:314,columnNumber:5},void 0)};export{Ee as default};
